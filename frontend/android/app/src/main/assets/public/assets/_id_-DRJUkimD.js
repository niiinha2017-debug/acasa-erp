import{x as q,y as $,g as u,f as w,K as H,L as Y,M as k,N as I,i as G,m as i,s as d,S as C,r as v,E as x,o as p,A as g,e as r,b as s,c as N,H as K,u as h,l as E,d as W,t as Q,q as P}from"./index-CH22lQIC.js";import{b as X,a as Z}from"./utils-haS6CNYB.js";const ee={class:"p-8 md:p-12 relative"},ae={class:"space-y-8"},le={class:"grid grid-cols-12 gap-x-8 gap-y-6 p-8 rounded-[2rem] bg-slate-50/50 border border-slate-100/50"},oe={class:"space-y-8"},se={class:"grid grid-cols-12 gap-x-8 gap-y-6 p-8 rounded-[2rem] border border-slate-100"},re={class:"space-y-8"},te={class:"grid grid-cols-12 gap-x-8 gap-y-6 p-8 rounded-[2rem] border border-slate-100"},ne={class:"pt-10 border-t border-slate-100 flex flex-col md:flex-row items-center justify-between gap-4"},de={key:1,class:"hidden md:block"},ue={class:"flex gap-4 w-full md:w-auto"},me={__name:"[id]",setup(ie){const V=q(),f=$(),n=u(()=>V.params.id&&V.params.id!=="novo"),c=u(()=>n.value?V.params.id:null),m=w(!1),b=w(!1),e=w({razao_social:"",nome_fantasia:"",cnpj:"",ie:"",email:"",telefone:"",whatsapp:"",forma_pagamento:"",data_vencimento:null,cep:"",endereco:"",numero:"",complemento:"",bairro:"",cidade:"",estado:""}),U=u({get:()=>e.value.cnpj,set:l=>e.value.cnpj=H(l)}),j=u({get:()=>e.value.ie,set:l=>e.value.ie=Y(l)}),B=u({get:()=>e.value.telefone,set:l=>e.value.telefone=k(l)}),F=u({get:()=>e.value.whatsapp,set:l=>e.value.whatsapp=k(l)}),_=u({get:()=>e.value.cep,set:l=>e.value.cep=I(l)});async function S(){if(!(!e.value.cnpj||String(e.value.cnpj).length<18)){m.value=!0;try{const l=await X(e.value.cnpj);l&&(Object.assign(e.value,{razao_social:l.razao_social||e.value.razao_social,nome_fantasia:l.nome_fantasia||e.value.nome_fantasia,telefone:l.telefone?k(l.telefone):e.value.telefone,cep:l.cep?I(l.cep):e.value.cep,endereco:l.endereco||e.value.endereco,numero:l.numero||e.value.numero,bairro:l.bairro||e.value.bairro,cidade:l.cidade||e.value.cidade,estado:l.estado||e.value.estado,ie:l.ie||e.value.ie}),d.success("Dados importados via CNPJ!"))}catch{d.error("Erro ao buscar CNPJ.")}finally{m.value=!1}}}async function z(){var a;if(!e.value.cep||String(e.value.cep).length<9)return;const l=await Z(e.value.cep);l&&(e.value.endereco=l.logradouro||"",e.value.bairro=l.bairro||"",e.value.cidade=l.localidade||"",e.value.estado=l.uf||"",(a=document.getElementById("numero-input"))==null||a.focus())}async function A(){const l=n.value?"fornecedores.editar":"fornecedores.criar";if(!i(l))return d.error("Acesso negado.");await P.show(n.value?"Salvar Alterações":"Finalizar Cadastro",n.value?`Deseja salvar as alterações do Fornecedor #${c.value}?`:"Deseja finalizar o cadastro deste fornecedor?")&&await O()}async function M(){if(!i("fornecedores.excluir"))return d.error("Acesso negado.");await P.show("Excluir Fornecedor",`Deseja realmente excluir o Fornecedor #${c.value}? Esta ação não pode ser desfeita.`)&&await D()}async function D(){if(!i("fornecedores.excluir"))return d.error("Acesso negado.");b.value=!0;try{await C.remover(c.value),d.success("Fornecedor removido."),f.push("/fornecedor")}catch{d.error("Erro ao excluir.")}finally{b.value=!1}}function L(){return{...e.value,data_vencimento:e.value.data_vencimento?Number(e.value.data_vencimento):null}}async function O(){const l=n.value?"fornecedores.editar":"fornecedores.criar";if(!i(l))return d.error("Acesso negado.");b.value=!0;try{const a=L();await C.salvar(c.value,a),d.success("Sucesso!"),f.push("/fornecedor")}catch{d.error("Erro ao salvar.")}finally{b.value=!1}}return G(async()=>{const l=n.value?"fornecedores.editar":"fornecedores.criar";if(!i(l)){d.error("Acesso negado."),f.push("/fornecedor");return}if(n.value){m.value=!0;try{const{data:a}=await C.buscar(c.value);e.value={...e.value,...a}}finally{m.value=!1}}}),(l,a)=>{const R=v("PageHeader"),T=v("Loading"),t=v("Input"),y=v("Button"),J=v("Card");return p(),x(J,{shadow:!0,class:"!rounded-[2.5rem] overflow-hidden border-none shadow-2xl shadow-slate-200/50"},{default:g(()=>[r(R,{title:n.value?"Editar Fornecedor":"Novo Fornecedor",subtitle:n.value?`ID: #${c.value}`:"Cadastro de parceiros comerciais",icon:"pi pi-truck",backTo:"/fornecedor",class:"bg-slate-50/50 border-b border-slate-100"},null,8,["title","subtitle"]),s("div",ee,[m.value?(p(),x(T,{key:0})):(p(),N("form",{key:1,class:"space-y-12",onSubmit:K(A,["prevent"])},[s("section",ae,[a[17]||(a[17]=s("div",{class:"flex items-center gap-4"},[s("div",{class:"w-10 h-10 rounded-xl bg-slate-900 text-white flex items-center justify-center shadow-lg"},[s("i",{class:"pi pi-id-card"})]),s("div",null,[s("h3",{class:"text-sm font-black uppercase tracking-widest text-slate-800"},"01. Identificação Jurídica"),s("p",{class:"text-[10px] text-slate-400 font-bold uppercase tracking-tight"},"Dados fiscais e registros oficiais")])],-1)),s("div",le,[r(t,{class:"col-span-12 md:col-span-4",modelValue:U.value,"onUpdate:modelValue":a[0]||(a[0]=o=>U.value=o),label:"CNPJ *",required:"",placeholder:"00.000.000/0000-00",onBlur:S},null,8,["modelValue"]),r(t,{class:"col-span-12 md:col-span-8",modelValue:e.value.razao_social,"onUpdate:modelValue":a[1]||(a[1]=o=>e.value.razao_social=o),label:"Razão Social *",required:"",placeholder:"Ex: CITYFER COMÉRCIO LTDA"},null,8,["modelValue"]),r(t,{class:"col-span-12 md:col-span-7",modelValue:e.value.nome_fantasia,"onUpdate:modelValue":a[2]||(a[2]=o=>e.value.nome_fantasia=o),label:"Nome Fantasia *",required:"",placeholder:"Ex: CITYFER"},null,8,["modelValue"]),r(t,{class:"col-span-12 md:col-span-5",modelValue:j.value,"onUpdate:modelValue":a[3]||(a[3]=o=>j.value=o),label:"Inscrição Estadual",placeholder:"Inscrição Estadual"},null,8,["modelValue"])])]),s("section",oe,[a[19]||(a[19]=s("div",{class:"flex items-center gap-4"},[s("div",{class:"w-10 h-10 rounded-xl bg-brand-primary text-white flex items-center justify-center shadow-lg shadow-brand-primary/20"},[s("i",{class:"pi pi-phone"})]),s("div",null,[s("h3",{class:"text-sm font-black uppercase tracking-widest text-slate-800"},"02. Contato e Comercial"),s("p",{class:"text-[10px] text-slate-400 font-bold uppercase tracking-tight"},"Canais de comunicação e acordos")])],-1)),s("div",se,[r(t,{class:"col-span-12 md:col-span-4",modelValue:e.value.email,"onUpdate:modelValue":a[4]||(a[4]=o=>e.value.email=o),label:"E-mail",placeholder:"contato@empresa.com",forceUpper:!1},null,8,["modelValue"]),r(t,{class:"col-span-12 md:col-span-4",modelValue:B.value,"onUpdate:modelValue":a[5]||(a[5]=o=>B.value=o),label:"Telefone",placeholder:"(00) 0000-0000"},null,8,["modelValue"]),r(t,{class:"col-span-12 md:col-span-4",modelValue:F.value,"onUpdate:modelValue":a[6]||(a[6]=o=>F.value=o),label:"WhatsApp",placeholder:"(00) 00000-0000"},null,8,["modelValue"]),a[18]||(a[18]=s("div",{class:"col-span-12 h-px bg-slate-100 my-2"},null,-1)),r(t,{class:"col-span-12 md:col-span-8",modelValue:e.value.forma_pagamento,"onUpdate:modelValue":a[7]||(a[7]=o=>e.value.forma_pagamento=o),label:"Condição de Pagamento Padrão",placeholder:"Ex: BOLETO 30 DIAS"},null,8,["modelValue"]),r(t,{class:"col-span-12 md:col-span-4",modelValue:e.value.data_vencimento,"onUpdate:modelValue":a[8]||(a[8]=o=>e.value.data_vencimento=o),modelModifiers:{number:!0},type:"number",label:"Melhor Dia Vencimento",placeholder:"Ex: 10"},null,8,["modelValue"])])]),s("section",re,[a[20]||(a[20]=s("div",{class:"flex items-center gap-4"},[s("div",{class:"w-10 h-10 rounded-xl bg-emerald-500 text-white flex items-center justify-center shadow-lg shadow-emerald-500/20"},[s("i",{class:"pi pi-map-marker"})]),s("div",null,[s("h3",{class:"text-sm font-black uppercase tracking-widest text-slate-800"},"03. Localização"),s("p",{class:"text-[10px] text-slate-400 font-bold uppercase tracking-tight"},"Endereço para faturamento e entregas")])],-1)),s("div",te,[r(t,{class:"col-span-12 md:col-span-3",modelValue:_.value,"onUpdate:modelValue":a[9]||(a[9]=o=>_.value=o),label:"CEP",placeholder:"00000-000",onBlur:z},null,8,["modelValue"]),r(t,{class:"col-span-12 md:col-span-7",modelValue:e.value.endereco,"onUpdate:modelValue":a[10]||(a[10]=o=>e.value.endereco=o),label:"Endereço",placeholder:"Rua, Av..."},null,8,["modelValue"]),r(t,{id:"numero-input",class:"col-span-12 md:col-span-2",modelValue:e.value.numero,"onUpdate:modelValue":a[11]||(a[11]=o=>e.value.numero=o),label:"Nº",placeholder:"123"},null,8,["modelValue"]),r(t,{class:"col-span-12 md:col-span-12",modelValue:e.value.complemento,"onUpdate:modelValue":a[12]||(a[12]=o=>e.value.complemento=o),label:"Complemento",placeholder:"Ex: GALPÃO 2 / BLOCO B"},null,8,["modelValue"]),r(t,{class:"col-span-12 md:col-span-5",modelValue:e.value.bairro,"onUpdate:modelValue":a[13]||(a[13]=o=>e.value.bairro=o),label:"Bairro",placeholder:"Bairro"},null,8,["modelValue"]),r(t,{class:"col-span-12 md:col-span-5",modelValue:e.value.cidade,"onUpdate:modelValue":a[14]||(a[14]=o=>e.value.cidade=o),label:"Cidade",placeholder:"Cidade"},null,8,["modelValue"]),r(t,{class:"col-span-12 md:col-span-2",modelValue:e.value.estado,"onUpdate:modelValue":a[15]||(a[15]=o=>e.value.estado=o),label:"UF",maxlength:"2",placeholder:"SP"},null,8,["modelValue"])])]),s("div",ne,[n.value&&h(i)("fornecedores.excluir")?(p(),x(y,{key:0,variant:"danger",type:"button",onClick:M,class:"!rounded-2xl !px-8 hover:bg-red-600 transition-all font-bold uppercase text-[10px] tracking-widest w-full md:w-auto"},{default:g(()=>[...a[21]||(a[21]=[s("i",{class:"pi pi-trash mr-2"},null,-1),E(" Excluir Registro ",-1)])]),_:1})):(p(),N("div",de)),s("div",ue,[r(y,{variant:"secondary",type:"button",onClick:a[16]||(a[16]=o=>h(f).push("/fornecedor")),class:"flex-1 md:flex-none !rounded-2xl !px-8 !bg-white !border-slate-200 text-slate-500 font-bold uppercase text-[10px] tracking-widest"},{default:g(()=>[...a[22]||(a[22]=[E(" Voltar ",-1)])]),_:1}),h(i)(n.value?"fornecedores.editar":"fornecedores.criar")?(p(),x(y,{key:0,variant:"primary",type:"button",onClick:A,class:"flex-1 md:flex-none !rounded-2xl !px-12 !h-14 shadow-2xl shadow-brand-primary/30 font-black uppercase text-[11px] tracking-[0.15em]"},{default:g(()=>[a[23]||(a[23]=s("i",{class:"pi pi-save mr-3"},null,-1)),E(" "+Q(n.value?"Salvar Alterações":"Finalizar Cadastro"),1)]),_:1})):W("",!0)])])],32))])]),_:1})}}};export{me as default};
//# sourceMappingURL=_id_-DRJUkimD.js.map
