import{y as B,f as x,g as I,i as O,m as i,s as d,r as E,c as w,o as f,b as t,k as $,E as P,d as _,w as z,v as M,u as r,A as c,l as V,t as n,P as b,e as R,p as F,a6 as S,q as G}from"./index-CH22lQIC.js";const q={class:"w-full max-w-[1200px] mx-auto space-y-4 animate-page-in"},H={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 p-2"},J={class:"flex flex-col sm:flex-row items-center gap-2 w-full sm:w-auto"},K={class:"relative w-full sm:w-64"},Q={class:"grid grid-cols-2 lg:grid-cols-4 gap-3"},W={class:"p-4 rounded-xl bg-white border border-slate-200 shadow-sm"},X={class:"text-xl font-black text-slate-800"},Y={class:"p-4 rounded-xl bg-white border border-slate-200 shadow-sm"},Z={class:"text-xl font-black text-emerald-600"},ee={class:"p-4 rounded-xl bg-white border border-slate-200 shadow-sm"},te={class:"text-xl font-black text-blue-600"},se={class:"p-4 rounded-xl bg-white border border-slate-200 shadow-sm"},ae={class:"flex items-center gap-2"},le={class:"text-xl font-black text-amber-600"},oe={class:"rounded-xl border border-slate-200 bg-white overflow-hidden shadow-sm"},re={class:"flex flex-col py-1"},ne={class:"text-sm font-bold text-slate-800 uppercase tracking-tight leading-tight"},ie={class:"text-[10px] font-bold text-slate-400 tracking-wider uppercase"},de={class:"flex flex-col items-end"},ce={class:"text-sm font-black text-slate-800 tabular-nums"},ue={class:"flex flex-col"},pe={class:"text-xs font-bold text-slate-700"},xe={class:"flex justify-end gap-1.5 px-2"},fe=["onClick"],be=["onClick"],ve={__name:"index",setup(me){const m=B(),g=x(!1),k=x(null),o=x([]),v=x(""),N=[{key:"id",label:"ID",width:"80px"},{key:"cliente",label:"CLIENTE",width:"35%"},{key:"status",label:"SITUAÇÃO",width:"15%",align:"center"},{key:"forma_pagamento_chave",label:"PAGAMENTO",width:"15%"},{key:"data_venda",label:"DATA",width:"15%"},{key:"valor_total",label:"TOTAL",align:"right",width:"15%"},{key:"acoes",label:"",width:"120px",align:"right"}],D=I(()=>{const a=String(v.value||"").toLowerCase().trim();return a?o.value.filter(e=>{const u=(e==null?void 0:e.cliente)||{},h=String(u.nome_completo||u.razao_social||u.nome||"").toLowerCase(),s=String((e==null?void 0:e.status)||"").toLowerCase(),l=String((e==null?void 0:e.forma_pagamento_chave)||"").toLowerCase(),p=String((e==null?void 0:e.id)||"").toLowerCase();return h.includes(a)||s.includes(a)||l.includes(a)||p.includes(a)}):o.value});function L(a){const e=String(a||"").toUpperCase();return e.includes("FECH")?"bg-emerald-50 text-emerald-600 border border-emerald-100":e.includes("CANCEL")?"bg-rose-50 text-rose-500 border border-rose-100":e.includes("PRODU")?"bg-sky-50 text-sky-600 border border-sky-100":"bg-slate-50 text-slate-500 border border-slate-200"}async function y(){if(!i("vendas.ver"))return d.error("Acesso negado.");g.value=!0;try{const{data:a}=await S.get("/vendas");o.value=Array.isArray(a)?a:[]}catch{d.error("Erro ao carregar vendas.")}finally{g.value=!1}}async function U(a){if(!i("vendas.excluir"))return d.error("Acesso negado.");await G.show("Excluir Venda",`Deseja excluir a Venda #${a}? Esta ação não pode ser desfeita.`)&&await j(a)}async function j(a){if(!i("vendas.excluir"))return d.error("Acesso negado.");k.value=a;try{await S.delete(`/vendas/${a}`),await y(),d.success("Venda removida.")}catch{d.error("Erro ao excluir.")}finally{k.value=null}}return O(async()=>{if(!i("vendas.ver")){d.error("Acesso negado."),m.push("/");return}await y()}),(a,e)=>{const u=E("Button"),h=E("Table");return f(),w("div",q,[t("div",H,[e[4]||(e[4]=$('<div class="flex items-center gap-3"><div class="w-10 h-10 rounded-xl bg-slate-900 text-white flex items-center justify-center"><i class="pi pi-dollar text-lg"></i></div><div><h1 class="text-lg font-black text-slate-800 uppercase tracking-tight">Vendas</h1><p class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Gestão comercial e pós-venda</p></div></div>',1)),t("div",J,[t("div",K,[e[2]||(e[2]=t("i",{class:"pi pi-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-xs"},null,-1)),z(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>v.value=s),type:"text",placeholder:"BUSCAR CLIENTE, STATUS OU ID...",class:"w-full pl-9 pr-3 h-10 bg-white border border-slate-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-brand-primary/10 focus:border-brand-primary outline-none transition-all uppercase"},null,512),[[M,v.value]])]),r(i)("vendas.criar")?(f(),P(u,{key:0,variant:"primary",size:"md",class:"!h-10 !rounded-xl !px-4 text-xs font-black uppercase tracking-wider w-full sm:w-auto",onClick:e[1]||(e[1]=s=>r(m).push("/vendas/novo"))},{default:c(()=>[...e[3]||(e[3]=[t("i",{class:"pi pi-plus mr-1.5 text-[10px]"},null,-1),V(" Nova Venda ",-1)])]),_:1})):_("",!0)])]),t("div",Q,[t("div",W,[e[5]||(e[5]=t("p",{class:"text-[9px] font-black uppercase tracking-[0.15em] text-slate-400 mb-1"},"Total de Vendas",-1)),t("p",X,n(o.value.length),1)]),t("div",Y,[e[6]||(e[6]=t("p",{class:"text-[9px] font-black uppercase tracking-[0.15em] text-slate-400 mb-1"},"Faturamento Total",-1)),t("p",Z,n(r(b).currency(o.value.reduce((s,l)=>s+Number(l.valor_vendido||0),0))),1)]),t("div",ee,[e[7]||(e[7]=t("p",{class:"text-[9px] font-black uppercase tracking-[0.15em] text-slate-400 mb-1"},"Ticket Médio",-1)),t("p",te,n(r(b).currency(o.value.length?o.value.reduce((s,l)=>s+Number(l.valor_vendido||0),0)/o.value.length:0)),1)]),t("div",se,[e[9]||(e[9]=t("p",{class:"text-[9px] font-black uppercase tracking-[0.15em] text-slate-400 mb-1"},"Em Produção",-1)),t("div",ae,[t("p",le,n(o.value.filter(s=>String(s.status).toUpperCase().includes("PRODU")).length),1),e[8]||(e[8]=t("span",{class:"w-1.5 h-1.5 rounded-full bg-amber-400 animate-pulse"},null,-1))])])]),t("div",oe,[R(h,{columns:N,rows:D.value,loading:g.value,boxed:!1},{"cell-cliente":c(({row:s})=>{var l,p,C,T,A;return[t("div",re,[t("span",ne,n(((l=s.cliente)==null?void 0:l.nome_completo)||((p=s.cliente)==null?void 0:p.razao_social)||((C=s.cliente)==null?void 0:C.nome)||"Consumidor"),1),t("span",ie,n(((T=s.cliente)==null?void 0:T.cpf)||((A=s.cliente)==null?void 0:A.cnpj)||"Sem documento"),1)])]}),"cell-status":c(({row:s})=>[t("span",{class:F(["px-2 py-1 rounded text-[9px] font-black uppercase inline-flex items-center gap-1.5",L(s.status)])},[e[10]||(e[10]=t("span",{class:"w-1.5 h-1.5 rounded-full bg-current"},null,-1)),V(" "+n(s.status),1)],2)]),"cell-valor_total":c(({row:s})=>[t("div",de,[t("span",ce,n(r(b).currency(s.valor_total)),1),e[11]||(e[11]=t("span",{class:"text-[9px] font-bold text-slate-400 uppercase tracking-tighter"},"Valor Final",-1))])]),"cell-data_venda":c(({row:s})=>[t("div",ue,[t("span",pe,n(r(b).date(s.data_venda)),1),e[12]||(e[12]=t("span",{class:"text-[9px] font-bold text-slate-400 uppercase"},"Data Venda",-1))])]),"cell-acoes":c(({row:s})=>[t("div",xe,[r(i)("vendas.editar")?(f(),w("button",{key:0,onClick:l=>r(m).push(`/vendas/${s.id}`),class:"w-7 h-7 rounded-lg bg-slate-100 text-slate-500 hover:bg-slate-900 hover:text-white transition-all border border-slate-200 flex items-center justify-center"},[...e[13]||(e[13]=[t("i",{class:"pi pi-pencil text-[10px]"},null,-1)])],8,fe)):_("",!0),r(i)("vendas.excluir")?(f(),w("button",{key:1,onClick:l=>U(s.id),class:"w-7 h-7 rounded-lg bg-rose-50 text-rose-500 hover:bg-rose-500 hover:text-white transition-all border border-rose-100 flex items-center justify-center"},[...e[14]||(e[14]=[t("i",{class:"pi pi-trash text-[10px]"},null,-1)])],8,be)):_("",!0)])]),_:1},8,["rows","loading"])])])}}};export{ve as default};
//# sourceMappingURL=index-BFCCuOpA.js.map
