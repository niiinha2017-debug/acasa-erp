import{y as W,f,g as D,Y as E,i as Z,r as C,c as b,o as d,b as s,E as q,d as x,k as ee,w as te,v as se,u as c,m as n,A as w,l as S,t as u,p as k,e as T,I as ae,J as oe,a2 as V,s as i,q as U,a6 as re}from"./index-CH22lQIC.js";const ne={class:"w-full max-w-[1200px] mx-auto space-y-4 animate-page-in"},le={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 p-2"},ie={class:"flex flex-col sm:flex-row items-center gap-2 w-full sm:w-auto"},ce={class:"relative w-full sm:w-64"},ue={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"},de={class:"p-4 rounded-xl bg-white border border-slate-200 shadow-sm"},pe={class:"text-xl font-black text-slate-800"},fe={class:"p-4 rounded-xl bg-white border border-emerald-200 shadow-sm"},xe={class:"text-xl font-black text-emerald-700"},ge=["disabled"],me={class:"rounded-xl border border-slate-200 bg-white overflow-hidden shadow-sm"},ve={class:"flex items-center gap-3 py-1"},be={class:"flex flex-col"},he={class:"text-sm font-bold text-slate-800 uppercase tracking-tight"},ye={class:"text-[10px] font-medium text-slate-500"},we={key:0,class:"ml-2 text-slate-400"},ke={class:"flex flex-col"},_e={class:"text-sm font-medium text-slate-700 uppercase"},Ae={class:"text-[10px] font-bold text-slate-400 uppercase tracking-tighter"},Ce={class:"flex justify-end gap-1"},Se=["onClick"],Fe=["onClick"],Ie=["onClick"],De={__name:"index",setup(Ne){const F=W(),I=f(!0),N=f(!1),O=f(""),p=f([]),_=f(!1),A=f(null),l=f(new Set),h=D(()=>l.value.size),R=D(()=>p.value.filter(t=>String(t.status||"").toUpperCase()==="ATIVO").length),P=[{key:"nome",label:"FUNCIONÁRIO",width:"40%"},{key:"cargo",label:"CARGO / SETOR",width:"25%"},{key:"status",label:"STATUS",width:"15%"},{key:"acoes",label:"",align:"right",width:"20%"}];function j(t){const e=new Set(l.value);e.has(t)?e.delete(t):e.add(t),l.value=e}function $(t){return l.value.has(t)}const M=D(()=>{const t=String(O.value||"").toLowerCase().trim();if(!t)return p.value;const e=E(t);return p.value.filter(r=>{const g=String(r.nome||"").toLowerCase(),m=String(r.cargo||"").toLowerCase(),o=String(r.setor||"").toLowerCase(),v=E(String(r.cpf||"")),a=E(String(r.rg||"")),y=g.includes(t)||m.includes(t)||o.includes(t),Q=e?v.includes(e)||a.includes(e):!1;return y||Q})});async function B(){var t,e,r,g,m;I.value=!0;try{const o=await V.listar();console.log("[FUNCIONARIOS] resp:",o);const v=Array.isArray(o==null?void 0:o.data)&&o.data||Array.isArray(o)&&o||Array.isArray((t=o==null?void 0:o.data)==null?void 0:t.data)&&o.data.data||Array.isArray((e=o==null?void 0:o.data)==null?void 0:e.items)&&o.data.items||Array.isArray((r=o==null?void 0:o.data)==null?void 0:r.rows)&&o.data.rows||[];p.value=v.map(a=>({...a,nome:a.nome??a.nome_completo??"",cargo:a.cargo??a.funcao??"",rg:a.rg??""}))}catch(o){console.log("[FUNCIONARIOS] erro:",o),i.error(((m=(g=o==null?void 0:o.response)==null?void 0:g.data)==null?void 0:m.message)||"Erro ao carregar lista de funcionários.")}finally{I.value=!1}}async function G(){if(l.value.size!==0){N.value=!0;try{const t=Array.from(l.value),{data:e}=await re.post("/funcionarios/pdf",{ids:t}),r=e==null?void 0:e.arquivoId;if(!r)throw new Error;i.success("PDF gerado com sucesso!"),F.push(`/arquivos/${String(r).replace(/\D/g,"")}`),l.value.clear()}catch{i.error("Falha ao gerar documento PDF.")}finally{N.value=!1}}}async function z(){if(!n("funcionarios.ver"))return i.error("Acesso negado.");if(l.value.size===0)return;await U.show("Gerar PDF",`Deseja gerar o PDF com ${l.value.size} funcionário(s) selecionado(s)?`)&&await G()}function L(t){if(!n("funcionarios.ver"))return i.error("Acesso negado.");A.value=t,_.value=!0}function J(){_.value=!1,A.value=null}const X=()=>{if(!n("funcionarios.criar"))return i.error("Acesso negado.");F.push("/funcionarios/novo")},Y=t=>{if(!n("funcionarios.editar"))return i.error("Acesso negado.");F.push(`/funcionarios/${t}`)};async function H(t){if(!n("funcionarios.excluir"))return i.error("Acesso negado.");await U.show("Excluir Funcionário",`Deseja remover "${t==null?void 0:t.nome}"? Esta ação não pode ser desfeita.`)&&await K(t)}async function K(t){try{await V.remover(t.id),p.value=p.value.filter(e=>e.id!==t.id),l.value.delete(t.id),i.success("Funcionário removido.")}catch{i.error("Erro ao tentar excluir funcionário.")}}return Z(B),(t,e)=>{var v;const r=C("Button"),g=C("CustomCheckbox"),m=C("Table"),o=C("ArquivosModal");return d(),b("div",ne,[s("div",le,[e[4]||(e[4]=ee('<div class="flex items-center gap-3"><div class="w-10 h-10 rounded-xl bg-slate-900 text-white flex items-center justify-center"><i class="pi pi-users text-lg"></i></div><div><h1 class="text-lg font-black text-slate-800 uppercase tracking-tight">Equipe</h1><p class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Gestão de capital humano</p></div></div>',1)),s("div",ie,[s("div",ce,[e[2]||(e[2]=s("i",{class:"pi pi-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-xs"},null,-1)),te(s("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>O.value=a),type:"text",placeholder:"BUSCAR NOME, CPF OU CARGO...",class:"w-full pl-9 pr-3 h-10 bg-white border border-slate-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-brand-primary/10 focus:border-brand-primary outline-none transition-all uppercase"},null,512),[[se,O.value]])]),c(n)("funcionarios.criar")?(d(),q(r,{key:0,variant:"primary",size:"md",class:"!h-10 !rounded-xl !px-4 text-xs font-black uppercase tracking-wider w-full sm:w-auto",onClick:e[1]||(e[1]=a=>X())},{default:w(()=>[...e[3]||(e[3]=[s("i",{class:"pi pi-plus mr-1.5 text-[10px]"},null,-1),S(" Novo ",-1)])]),_:1})):x("",!0)])]),s("div",ue,[s("div",de,[e[5]||(e[5]=s("p",{class:"text-[9px] font-black uppercase tracking-[0.15em] text-slate-400"},"Equipe Total",-1)),s("p",pe,u(p.value.length),1)]),s("div",fe,[e[6]||(e[6]=s("p",{class:"text-[9px] font-black uppercase tracking-[0.15em] text-emerald-600"},"Ativos",-1)),s("p",xe,u(R.value),1)]),s("div",{class:k(["p-4 rounded-xl border transition-all flex items-center justify-between",h.value>0?"bg-slate-900 border-slate-900 shadow-lg shadow-slate-200":"bg-white border-slate-200 shadow-sm"])},[s("div",null,[s("p",{class:k(["text-[9px] font-black uppercase tracking-[0.15em]",(h.value>0,"text-slate-400")])}," Selecionados ",2),s("p",{class:k(["text-xl font-black",h.value>0?"text-white":"text-slate-800"])},u(h.value),3)]),h.value>0&&c(n)("funcionarios.ver")?(d(),b("button",{key:0,onClick:z,disabled:N.value,class:"px-3 py-1.5 rounded-lg bg-brand-primary text-white text-[9px] font-black uppercase tracking-wider flex items-center gap-2 hover:brightness-110 active:scale-95 transition-all disabled:opacity-60 disabled:pointer-events-none"},[...e[7]||(e[7]=[s("i",{class:"pi pi-file-pdf"},null,-1),S(" PDF ",-1)])],8,ge)):x("",!0)],2)]),s("div",me,[T(m,{columns:P,rows:M.value,loading:I.value,"empty-text":"Nenhum colaborador encontrado.",boxed:!1},{"cell-nome":w(({row:a})=>[s("div",ve,[T(g,{modelValue:$(a.id),"onUpdate:modelValue":y=>j(a.id),label:"",class:"scale-90"},null,8,["modelValue","onUpdate:modelValue"]),s("div",be,[s("span",he,u(a.nome),1),s("span",ye,[S(u(a.cpf?c(ae)(a.cpf):"000.000.000-00")+" ",1),a.rg?(d(),b("span",we,"RG: "+u(c(oe)(a.rg)),1)):x("",!0)])])])]),"cell-cargo":w(({row:a})=>[s("div",ke,[s("span",_e,u(a.cargo),1),s("span",Ae,u(a.setor),1)])]),"cell-status":w(({row:a})=>[s("span",{class:k(["px-2 py-1 rounded text-[9px] font-black uppercase inline-flex items-center gap-1.5",String(a.status||"").toUpperCase()==="ATIVO"?"bg-emerald-50 text-emerald-600 border border-emerald-100":"bg-slate-100 text-slate-500 border border-slate-200"])},[s("span",{class:k(["w-1.5 h-1.5 rounded-full",String(a.status||"").toUpperCase()==="ATIVO"?"bg-emerald-500":"bg-slate-400"])},null,2),S(" "+u(a.status||"INATIVO"),1)],2)]),"cell-acoes":w(({row:a})=>[s("div",Ce,[c(n)("funcionarios.ver")?(d(),b("button",{key:0,onClick:y=>L(a),class:"w-7 h-7 rounded-lg bg-slate-50 text-slate-400 hover:bg-slate-900 hover:text-white transition-all flex items-center justify-center border border-slate-100",title:"Documentos"},[...e[8]||(e[8]=[s("i",{class:"pi pi-paperclip text-xs"},null,-1)])],8,Se)):x("",!0),c(n)("funcionarios.editar")?(d(),b("button",{key:1,onClick:y=>Y(a.id),class:"w-7 h-7 rounded-lg bg-slate-100 text-slate-500 hover:bg-brand-primary hover:text-white transition-all flex items-center justify-center",title:"Editar"},[...e[9]||(e[9]=[s("i",{class:"pi pi-pencil text-xs"},null,-1)])],8,Fe)):x("",!0),c(n)("funcionarios.excluir")?(d(),b("button",{key:2,onClick:y=>H(a),class:"w-7 h-7 rounded-lg bg-red-50 text-red-500 hover:bg-red-500 hover:text-white transition-all flex items-center justify-center",title:"Excluir"},[...e[10]||(e[10]=[s("i",{class:"pi pi-trash text-xs"},null,-1)])],8,Ie)):x("",!0)])]),_:1},8,["rows","loading"])]),_.value&&((v=A.value)!=null&&v.id)?(d(),q(o,{key:0,open:_.value,ownerType:"FUNCIONARIO",ownerId:A.value.id,categoria:"ANEXO",canManage:c(n)("arquivos.criar")||c(n)("arquivos.excluir"),onClose:J},null,8,["open","ownerId","canManage"])):x("",!0)])}}};export{De as default};
//# sourceMappingURL=index-DplIA4d4.js.map
