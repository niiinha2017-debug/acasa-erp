import{y as ae,f as m,g as w,K as S,Y as y,N as le,L as te,M as oe,i as se,Z as N,r as O,c as f,o as c,b as o,k as ne,E as R,d as k,u as z,m as V,A as h,l as C,e as r,F as re,n as ie,t as de,w as ue,v as ce,D as v,q as E,s as i}from"./index-CH22lQIC.js";import{b as pe,a as me}from"./utils-haS6CNYB.js";const ve={class:"w-full max-w-[1200px] mx-auto space-y-6 animate-page-in pb-20"},fe={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 p-2"},ge={class:"flex items-center gap-2 w-full sm:w-auto"},be={class:"bg-white border border-slate-200 rounded-2xl shadow-sm overflow-hidden"},xe={class:"grid grid-cols-12 divide-y lg:divide-y-0 lg:divide-x divide-slate-100"},we={class:"col-span-12 lg:col-span-4 p-8 bg-slate-50/30 space-y-10"},ye=["src"],ke={key:1,class:"flex flex-col items-center text-slate-300"},Ve={class:"mt-3 flex justify-center lg:justify-start"},he={class:"space-y-2 mb-4"},Ce={class:"flex items-center gap-2 overflow-hidden"},Ee={class:"text-[10px] font-bold text-slate-600 truncate uppercase"},Ae={class:"flex items-center gap-2"},De=["onClick"],Pe=["onClick"],Ue={key:0,class:"text-center py-6 border-2 border-dashed border-slate-100 rounded-2xl"},_e={class:"col-span-12 lg:col-span-8 p-8 lg:p-12 space-y-10"},$e={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},Ie={class:"grid grid-cols-12 gap-5"},Re={class:"grid grid-cols-1 md:grid-cols-2 gap-5 p-6 rounded-2xl bg-slate-50 border border-slate-100"},Le={class:"md:col-span-2"},je={class:"relative"},ze={__name:"configuracoes",setup(Se){const B=ae(),g=m(null),b=m(null),A=m(!1),D=m(!1),P=m(!1),u=m(""),x=m([]);function M(){var l;(l=b.value)==null||l.click()}const a=m({razao_social:"",nome_fantasia:"",cnpj:"",ie:"",cep:"",logradouro:"",numero:"",bairro:"",cidade:"",uf:"",email:"",telefone:"",banco_titular:"",banco_nome:"",banco_agencia:"",banco_conta:"",pix:""}),U=w({get:()=>S(a.value.cnpj),set:l=>a.value.cnpj=y(l).slice(0,14)}),_=w({get:()=>le(a.value.cep),set:l=>a.value.cep=y(l).slice(0,8)}),L=w({get:()=>te(a.value.ie),set:l=>a.value.ie=y(l).slice(0,12)}),$=w({get:()=>oe(a.value.telefone),set:l=>a.value.telefone=y(l).slice(0,11)}),T=async()=>{const l=a.value.cnpj.replace(/\D/g,"");if(l.length===14)try{const e=await pe(l);e&&(a.value.razao_social=e.razao_social||a.value.razao_social,a.value.nome_fantasia=e.nome_fantasia||a.value.nome_fantasia,a.value.logradouro=e.endereco||"",a.value.numero=e.numero||"",a.value.bairro=e.bairro||"",a.value.cidade=e.cidade||"",a.value.uf=(e.estado||"").toUpperCase(),a.value.cep=(e.cep||"").replace(/\D/g,""),e.ie&&(a.value.ie=e.ie),a.value.pix||(a.value.pix=S(l)),i.success("Dados importados com sucesso!"))}catch{i.error("Erro ao consultar CNPJ")}},q=async()=>{const l=a.value.cep.replace(/\D/g,"");if(l.length!==8)return;const e=await me(l);e&&!e.erro&&(a.value.logradouro=e.logradouro,a.value.bairro=e.bairro,a.value.cidade=e.localidade,a.value.uf=e.uf,i.success("Endereço atualizado!"))};async function j(){try{const l=await v.listar({ownerType:"EMPRESA",ownerId:1,categoria:"LOGO"}),e=(l==null?void 0:l.data)??l,n=Array.isArray(e)?e:[],s=n.find(t=>String(t.slot_key||"")==="LOGO_PRINCIPAL")||n[0];u.value=(s==null?void 0:s.url)||""}catch{u.value=""}}async function I(){try{const l=await v.listar({ownerType:"EMPRESA",ownerId:1,categoria:"ANEXO"}),e=(l==null?void 0:l.data)??l;x.value=Array.isArray(e)?e:[]}catch{x.value=[]}}const F=async l=>{var n,s,t,d;const e=(n=l.target.files)==null?void 0:n[0];if(e){(s=u.value)!=null&&s.startsWith("blob:")&&URL.revokeObjectURL(u.value),u.value=URL.createObjectURL(e);try{await v.upload({ownerType:"EMPRESA",ownerId:1,categoria:"LOGO",slotKey:"LOGO_PRINCIPAL",file:e}),i.success("Logo enviada!"),await j()}catch(p){i.error(((d=(t=p==null?void 0:p.response)==null?void 0:t.data)==null?void 0:d.message)||"Erro ao enviar logo.")}finally{g.value&&(g.value.value="")}}};async function G(){var e,n;if(await E.show("Remover Logo","Deseja realmente remover a logomarca?")){D.value=!0;try{const s=await v.listar({ownerType:"EMPRESA",ownerId:1,categoria:"LOGO"}),t=(s==null?void 0:s.data)??s,d=Array.isArray(t)?t:[],p=d.find(ee=>String(ee.slot_key||"")==="LOGO_PRINCIPAL")||d[0];p!=null&&p.id&&await v.remover(p.id),u.value="",i.success("Logo removida!")}catch(s){i.error(((n=(e=s==null?void 0:s.response)==null?void 0:e.data)==null?void 0:n.message)||"Erro ao remover logo.")}finally{D.value=!1}}}const J=async l=>{var n,s,t;const e=(n=l.target.files)==null?void 0:n[0];if(e){P.value=!0;try{await v.upload({ownerType:"EMPRESA",ownerId:1,categoria:"ANEXO",file:e}),i.success("Documento anexado."),await I()}catch(d){i.error(((t=(s=d==null?void 0:d.response)==null?void 0:s.data)==null?void 0:t.message)||"Erro ao anexar documento.")}finally{P.value=!1,b.value&&(b.value.value="")}}};async function X(l){var n,s;if(await E.show("Remover Documento",`Deseja remover o documento "${(l==null?void 0:l.nome)||(l==null?void 0:l.filename)||"SEM NOME"}"?`))try{await v.remover(l.id),i.success("Documento removido."),await I()}catch(t){i.error(((s=(n=t==null?void 0:t.response)==null?void 0:n.data)==null?void 0:s.message)||"Erro ao remover documento.")}}function K(l){const e=encodeURIComponent((l==null?void 0:l.nome)||(l==null?void 0:l.filename)||"ARQUIVO"),n=encodeURIComponent((l==null?void 0:l.mime_type)||""),s=encodeURIComponent("/configuracoes/empresa");B.push(`/arquivos/${l.id}?name=${e}&type=${n}&backTo=${s}`)}const W=()=>{a.value.pix&&navigator.clipboard.writeText(a.value.pix).then(()=>{i.success("Chave Pix copiada!")})},Q=async()=>{if(!V("configuracoes.empresa.editar"))return i.error("Acesso negado.");A.value=!0;try{await N.salvar(a.value),i.success("Configurações salvas!")}catch{i.error("Erro ao salvar.")}finally{A.value=!1}};async function Y(){if(!V("configuracoes.empresa.editar"))return i.error("Acesso negado.");await E.show("Salvar Dados da Empresa","Deseja salvar as configurações fiscais e de recebimento?")&&await Q()}async function Z(){await E.show("Exportar Dados da Empresa","Deseja exportar os dados cadastrais para impressão/PDF?")&&H()}const H=()=>{const l=window.open("","_blank");l.document.write(`
    <html>
      <head>
        <title>Dados Cadastrais - ${a.value.nome_fantasia}</title>
        <style>
          body { font-family: sans-serif; padding: 40px; color: #333; line-height: 1.6; }
          .header { display: flex; align-items: center; border-bottom: 2px solid #333; padding-bottom: 20px; margin-bottom: 30px; }
          .logo { max-width: 150px; max-height: 100px; margin-right: 20px; }
          .title { font-size: 20px; font-weight: bold; text-transform: uppercase; }
          .section-title { background: #f4f4f4; padding: 10px; font-size: 16px; font-weight: bold; margin-top: 25px; border-left: 5px solid #333; }
          .data-row { margin: 8px 0; font-size: 14px; }
          .label { font-weight: bold; min-width: 120px; display: inline-block; }
        </style>
      </head>
      <body>
        <div class="header">
          ${u.value?`<img src="${u.value}" class="logo" />`:""}
          <div class="title">DADOS CADASTRAIS - ${a.value.nome_fantasia}</div>
        </div>

        <div class="data-row"><span class="label">Razão Social:</span> ${a.value.razao_social}</div>
        <div class="data-row"><span class="label">CNPJ:</span> ${U.value} ${a.value.ie?`| <span class="label">IE:</span> ${a.value.ie}`:""}</div>
        <div class="data-row"><span class="label">Endereço:</span> ${a.value.logradouro}, ${a.value.numero} - ${a.value.bairro}</div>
        <div class="data-row"><span class="label">Cidade:</span> ${a.value.cidade} - ${a.value.uf}</div>
        <div class="data-row"><span class="label">CEP:</span> ${_.value}</div>
        <div class="data-row"><span class="label">Contato:</span> ${a.value.email} | ${$.value}</div>

        <div class="section-title">DADOS BANCÁRIOS E PIX</div>
        <div class="data-row"><span class="label">Titular:</span> ${a.value.banco_titular}</div>
        <div class="data-row"><span class="label">Banco:</span> ${a.value.banco_nome||"Não informado"}</div>
        <div class="data-row"><span class="label">Agência:</span> ${a.value.banco_agencia} | <span class="label" style="min-width:auto">Conta:</span> ${a.value.banco_conta}</div>
        <div class="data-row"><span class="label">Chave PIX:</span> <strong>${a.value.pix||"Não informada"}</strong></div>

        <div style="margin-top: 50px; font-size: 10px; color: #999; text-align: center; border-top: 1px solid #EEE; padding-top: 10px;">
          Documento gerado em ${new Date().toLocaleDateString("pt-BR")} via Sistema ERP ACASA
        </div>
      </body>
    </html>
  `),l.document.close(),setTimeout(()=>{l.print()},500)};return se(async()=>{const l=await N.carregar();l&&Object.assign(a.value,l),await j(),await I()}),(l,e)=>{const n=O("Button"),s=O("Input");return c(),f("div",ve,[o("div",fe,[e[20]||(e[20]=ne('<div class="flex items-center gap-3"><div class="w-10 h-10 rounded-xl bg-slate-900 text-white flex items-center justify-center"><i class="pi pi-building text-lg"></i></div><div><h1 class="text-lg font-black text-slate-800 uppercase tracking-tight">Dados da Empresa</h1><p class="text-[10px] font-bold text-slate-400 uppercase tracking-wider"> Configurações fiscais e de recebimento </p></div></div>',1)),o("div",ge,[z(V)("configuracoes.empresa.ver")?(c(),R(n,{key:0,variant:"ghost",class:"flex-1 sm:flex-none !rounded-xl text-[10px] font-black uppercase tracking-widest border border-slate-200",onClick:Z},{default:h(()=>[...e[18]||(e[18]=[o("i",{class:"pi pi-external-link mr-2"},null,-1),C(" Exportar ",-1)])]),_:1})):k("",!0),z(V)("configuracoes.empresa.editar")?(c(),R(n,{key:1,class:"flex-1 sm:flex-none !rounded-xl text-[10px] font-black uppercase tracking-widest bg-brand-primary hover:bg-brand-primary/90",loading:A.value,onClick:Y},{default:h(()=>[...e[19]||(e[19]=[o("i",{class:"pi pi-check-circle mr-2"},null,-1),C(" Salvar Alterações ",-1)])]),_:1},8,["loading"])):k("",!0)])]),o("div",be,[o("div",xe,[o("div",we,[o("section",null,[e[23]||(e[23]=o("h3",{class:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-4 text-center lg:text-left"}," Logo da Marca ",-1)),o("div",{class:"relative aspect-square w-48 mx-auto lg:ml-0 rounded-2xl border-2 border-dashed border-slate-200 bg-white flex items-center justify-center overflow-hidden group cursor-pointer hover:border-brand-primary transition-all",onClick:e[0]||(e[0]=t=>{var d;return(d=g.value)==null?void 0:d.click()})},[u.value?(c(),f("img",{key:0,src:u.value,class:"object-contain w-full h-full p-6 transition-transform group-hover:scale-105",alt:"Logo"},null,8,ye)):(c(),f("div",ke,[...e[21]||(e[21]=[o("i",{class:"pi pi-images text-3xl mb-2"},null,-1),o("span",{class:"text-[9px] font-black uppercase text-center px-4"},"Clique para fazer upload",-1)])])),o("input",{type:"file",ref_key:"fileInput",ref:g,class:"hidden",accept:"image/*",onChange:F},null,544)]),o("div",Ve,[u.value?(c(),R(n,{key:0,variant:"ghost",size:"sm",class:"!h-9 !rounded-xl text-[10px] font-black uppercase tracking-widest border border-slate-200 text-slate-600 hover:bg-white hover:text-rose-500",type:"button",loading:D.value,onClick:G},{default:h(()=>[...e[22]||(e[22]=[o("i",{class:"pi pi-trash mr-2"},null,-1),C(" Remover logo ",-1)])]),_:1},8,["loading"])):k("",!0)])]),o("section",null,[e[29]||(e[29]=o("h3",{class:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-4"}," Arquivos e Documentos ",-1)),o("div",he,[(c(!0),f(re,null,ie(x.value,t=>(c(),f("div",{key:t.id,class:"flex items-center justify-between p-3 bg-white border border-slate-100 rounded-xl shadow-sm"},[o("div",Ce,[e[24]||(e[24]=o("i",{class:"pi pi-file text-slate-400"},null,-1)),o("span",Ee,de(t.nome||t.filename),1)]),o("div",Ae,[o("button",{type:"button",onClick:d=>K(t),class:"w-7 h-7 flex items-center justify-center rounded-lg bg-slate-50 text-slate-400 hover:text-brand-primary transition-colors"},[...e[25]||(e[25]=[o("i",{class:"pi pi-eye text-xs"},null,-1)])],8,De),o("button",{type:"button",onClick:d=>X(t),class:"w-7 h-7 flex items-center justify-center rounded-lg bg-slate-50 text-slate-300 hover:text-rose-500 transition-colors"},[...e[26]||(e[26]=[o("i",{class:"pi pi-times text-xs"},null,-1)])],8,Pe)])]))),128)),x.value.length?k("",!0):(c(),f("div",Ue,[...e[27]||(e[27]=[o("p",{class:"text-[9px] font-bold text-slate-400 uppercase tracking-tighter"},"Nenhum documento anexado",-1)])]))]),r(n,{variant:"ghost",class:"w-full !h-11 !rounded-xl text-[10px] font-black uppercase tracking-widest border-2 border-dashed border-slate-200 text-slate-500 hover:bg-slate-50",type:"button",loading:P.value,onClick:M},{default:h(()=>[...e[28]||(e[28]=[o("i",{class:"pi pi-paperclip mr-2"},null,-1),C(" Anexar Documento ",-1)])]),_:1},8,["loading"]),o("input",{type:"file",ref_key:"documentInput",ref:b,class:"hidden",onChange:J},null,544)])]),o("div",_e,[o("section",null,[e[30]||(e[30]=o("div",{class:"flex items-center gap-3 mb-6"},[o("span",{class:"w-1.5 h-1.5 rounded-full bg-brand-primary"}),o("h3",{class:"text-xs font-black text-slate-800 uppercase tracking-widest"},"Informações Fiscais")],-1)),o("div",$e,[r(s,{modelValue:a.value.razao_social,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.razao_social=t),label:"Razão Social",class:"md:col-span-2"},null,8,["modelValue"]),r(s,{modelValue:a.value.nome_fantasia,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.nome_fantasia=t),label:"Nome Fantasia"},null,8,["modelValue"]),r(s,{modelValue:U.value,"onUpdate:modelValue":e[3]||(e[3]=t=>U.value=t),label:"CNPJ",onBlur:T},null,8,["modelValue"]),r(s,{modelValue:L.value,"onUpdate:modelValue":e[4]||(e[4]=t=>L.value=t),label:"Inscrição Estadual"},null,8,["modelValue"]),r(s,{modelValue:a.value.email,"onUpdate:modelValue":e[5]||(e[5]=t=>a.value.email=t),label:"E-mail de Contato",icon:"pi pi-envelope"},null,8,["modelValue"])])]),o("section",null,[e[31]||(e[31]=o("div",{class:"flex items-center gap-3 mb-6"},[o("span",{class:"w-1.5 h-1.5 rounded-full bg-brand-primary"}),o("h3",{class:"text-xs font-black text-slate-800 uppercase tracking-widest"},"Endereço Principal")],-1)),o("div",Ie,[r(s,{modelValue:_.value,"onUpdate:modelValue":e[6]||(e[6]=t=>_.value=t),label:"CEP",class:"col-span-4",onBlur:q},null,8,["modelValue"]),r(s,{modelValue:a.value.logradouro,"onUpdate:modelValue":e[7]||(e[7]=t=>a.value.logradouro=t),label:"Rua/Logradouro",class:"col-span-8"},null,8,["modelValue"]),r(s,{modelValue:a.value.numero,"onUpdate:modelValue":e[8]||(e[8]=t=>a.value.numero=t),label:"Nº",class:"col-span-3"},null,8,["modelValue"]),r(s,{modelValue:a.value.bairro,"onUpdate:modelValue":e[9]||(e[9]=t=>a.value.bairro=t),label:"Bairro",class:"col-span-5"},null,8,["modelValue"]),r(s,{modelValue:a.value.cidade,"onUpdate:modelValue":e[10]||(e[10]=t=>a.value.cidade=t),label:"Cidade",class:"col-span-4"},null,8,["modelValue"]),r(s,{modelValue:a.value.uf,"onUpdate:modelValue":e[11]||(e[11]=t=>a.value.uf=t),label:"UF",class:"col-span-2",maxlength:"2"},null,8,["modelValue"]),r(s,{modelValue:$.value,"onUpdate:modelValue":e[12]||(e[12]=t=>$.value=t),label:"WhatsApp",icon:"pi pi-whatsapp",class:"col-span-10"},null,8,["modelValue"])])]),o("section",null,[e[34]||(e[34]=o("div",{class:"flex items-center gap-3 mb-6"},[o("span",{class:"w-1.5 h-1.5 rounded-full bg-emerald-500"}),o("h3",{class:"text-xs font-black text-slate-800 uppercase tracking-widest text-emerald-600"}," Dados Bancários e Pix ")],-1)),o("div",Re,[o("div",Le,[e[33]||(e[33]=o("label",{class:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1 block ml-1"}," Chave Pix (Aparece nos orçamentos) ",-1)),o("div",je,[ue(o("input",{"onUpdate:modelValue":e[13]||(e[13]=t=>a.value.pix=t),class:"w-full h-12 bg-white border border-slate-200 rounded-xl px-4 text-sm font-bold text-slate-700 focus:ring-2 focus:ring-brand-primary/10 focus:border-brand-primary outline-none transition-all",placeholder:"E-mail, CNPJ ou Celular"},null,512),[[ce,a.value.pix]]),o("button",{type:"button",onClick:W,class:"absolute right-3 top-1/2 -translate-y-1/2 w-8 h-8 flex items-center justify-center rounded-lg hover:bg-slate-50 text-slate-400 hover:text-brand-primary transition-colors"},[...e[32]||(e[32]=[o("i",{class:"pi pi-copy text-sm"},null,-1)])])])]),r(s,{modelValue:a.value.banco_nome,"onUpdate:modelValue":e[14]||(e[14]=t=>a.value.banco_nome=t),label:"Banco"},null,8,["modelValue"]),r(s,{modelValue:a.value.banco_titular,"onUpdate:modelValue":e[15]||(e[15]=t=>a.value.banco_titular=t),label:"Titular da Conta"},null,8,["modelValue"]),r(s,{modelValue:a.value.banco_agencia,"onUpdate:modelValue":e[16]||(e[16]=t=>a.value.banco_agencia=t),label:"Agência"},null,8,["modelValue"]),r(s,{modelValue:a.value.banco_conta,"onUpdate:modelValue":e[17]||(e[17]=t=>a.value.banco_conta=t),label:"Conta Corrente"},null,8,["modelValue"])])])])])])])}}};export{ze as default};
//# sourceMappingURL=configuracoes-B4RhcK-V.js.map
