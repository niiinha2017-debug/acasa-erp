{"version":3,"file":"index-CvXEgbsA.js","sources":["../../src/pages/producao/index.vue"],"sourcesContent":["<template>\r\n  <Card :shadow=\"true\" class=\"overflow-visible\">\r\n    <PageHeader \r\n      title=\"Agenda de Produção\" \r\n      subtitle=\"Chão de fábrica: grade semanal de tarefas.\" \r\n      icon=\"pi pi-calendar\" \r\n      backTo=\"/\" \r\n    />\r\n\r\n    <div class=\"p-6 relative\">\r\n      <Loading v-if=\"loading\" />\r\n\r\n      <div v-else class=\"space-y-8\">\r\n        <section class=\"flex flex-col md:flex-row gap-4 items-end justify-between bg-slate-50/50 p-4 rounded-3xl border border-slate-100\">\r\n          <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4 w-full md:w-2/3\">\r\n            <Input v-model=\"semanaInicio\" type=\"date\" label=\"Semana (início) *\" />\r\n            <SearchInput \r\n              v-model=\"busca\" \r\n              mode=\"search\" \r\n              label=\"Buscar\" \r\n              placeholder=\"Título, status, funcionário...\" \r\n            />\r\n          </div>\r\n\r\n          <div class=\"flex items-center gap-2\">\r\n            <div class=\"flex bg-white rounded-2xl border border-slate-200 p-1 shadow-sm\">\r\n              <button @click=\"voltarSemana\" class=\"p-2 hover:bg-slate-100 rounded-xl transition-colors text-slate-600\">◀</button>\r\n              <button @click=\"avancarSemana\" class=\"p-2 hover:bg-slate-100 rounded-xl transition-colors text-slate-600\">▶</button>\r\n            </div>\r\n            \r\n            <Button v-if=\"can('producao.ver')\" variant=\"secondary\" :loading=\"refreshing\" @click=\"carregar\">\r\n              <i class=\"pi pi-refresh\"></i>\r\n            </Button>\r\n            \r\n            <Button v-if=\"can('producao.criar')\" variant=\"primary\" @click=\"abrirNovaTarefaSolta\">\r\n              + Nova Tarefa\r\n            </Button>\r\n          </div>\r\n        </section>\r\n\r\n        <section class=\"grid grid-cols-2 md:grid-cols-4 gap-6 px-2\">\r\n          <header>\r\n            <p class=\"text-[10px] font-black uppercase tracking-[0.2em] text-slate-400\">Tarefas (Filtro)</p>\r\n            <p class=\"text-2xl font-black text-slate-800 tracking-tighter italic\">{{ tarefasFiltradas.length }}</p>\r\n          </header>\r\n          <header>\r\n            <p class=\"text-[10px] font-black uppercase tracking-[0.2em] text-slate-400\">Custo Total</p>\r\n            <p class=\"text-2xl font-black text-emerald-600 tracking-tighter italic\">{{ format.currency(totalCustoSemana) }}</p>\r\n          </header>\r\n        </section>\r\n\r\n        <section v-if=\"projetosPendentes.length\" class=\"bg-amber-50/40 p-6 rounded-[2.5rem] border border-amber-100\">\r\n          <h3 class=\"text-[11px] font-black uppercase tracking-widest text-amber-600 mb-4 flex items-center gap-2\">\r\n            <span class=\"w-2 h-2 rounded-full bg-amber-500 animate-pulse\"></span>\r\n            Projetos Encaminhados (Sem Tarefas)\r\n          </h3>\r\n          <div class=\"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-3\">\r\n            <button \r\n              v-for=\"p in projetosPendentes\" :key=\"p.id\" \r\n              @click=\"abrirNovaTarefaDeProjeto(p)\"\r\n              class=\"group bg-white p-4 rounded-2xl border border-slate-200 hover:border-amber-400 hover:shadow-lg transition-all text-left\"\r\n            >\r\n              <p class=\"text-[9px] font-black text-slate-400 uppercase tracking-tighter\">{{ p.origem_tipo }} #{{ p.origem_id }}</p>\r\n              <p class=\"text-xs font-bold text-slate-700 mt-1 group-hover:text-amber-700\">Agendar 1ª Tarefa</p>\r\n              <p class=\"text-[9px] text-slate-400 mt-2 italic italic\">Encaminhado em: {{ format.date(p.encaminhado_em) }}</p>\r\n            </button>\r\n          </div>\r\n        </section>\r\n\r\n        <section class=\"space-y-4\">\r\n          <div class=\"flex items-center justify-between px-2\">\r\n            <h3 class=\"text-[11px] font-black uppercase tracking-[0.25em] text-slate-400\">Semana: {{ semanaLabel }}</h3>\r\n          </div>\r\n          \r\n          <div class=\"overflow-x-auto pb-4 custom-scrollbar\">\r\n            <div class=\"min-w-[1100px] space-y-3\">\r\n              <div class=\"grid grid-cols-7 gap-3\">\r\n                <div v-for=\"d in diasSemana\" :key=\"d.key\" class=\"p-4 bg-slate-900 rounded-3xl text-white shadow-xl shadow-slate-200 relative overflow-hidden\">\r\n                  <p class=\"text-[9px] font-black uppercase opacity-50 tracking-[0.2em] mb-1\">{{ d.label }}</p>\r\n                  <p class=\"text-sm font-black italic tracking-tight\">{{ format.date(d.date) }}</p>\r\n                  <div class=\"absolute -right-2 -bottom-2 opacity-10 text-4xl font-black italic select-none\">{{ d.label[0] }}</div>\r\n                </div>\r\n              </div>\r\n\r\n              <div v-for=\"slot in SLOTS\" :key=\"slot\" class=\"grid grid-cols-7 gap-3\">\r\n                <div \r\n                  v-for=\"d in diasSemana\" :key=\"d.key + '-' + slot\"\r\n                  @dblclick=\"can('producao.criar') && abrirNovaTarefaNoSlot(d.date, slot)\"\r\n                  class=\"group min-h-[140px] rounded-[2rem] border border-slate-100 bg-white p-3 hover:border-brand-primary/40 transition-all hover:shadow-md relative\"\r\n                >\r\n                  <header class=\"flex justify-between items-center mb-2 px-1\">\r\n                    <span class=\"text-[10px] font-black text-slate-300 uppercase italic tracking-widest\">{{ slot }}</span>\r\n                    <button v-if=\"can('producao.criar')\" @click.stop=\"abrirNovaTarefaNoSlot(d.date, slot)\" class=\"opacity-0 group-hover:opacity-100 text-brand-primary hover:scale-110 transition-all\">\r\n                      <i class=\"pi pi-plus-circle text-sm\"></i>\r\n                    </button>\r\n                  </header>\r\n\r\n                  <div class=\"space-y-2\">\r\n                    <div \r\n                      v-for=\"t in tarefasNoSlot(d.date, slot)\" :key=\"t.id\"\r\n                      @click.stop=\"can('producao.editar') && editarTarefa(t)\"\r\n                      class=\"p-2.5 rounded-2xl border border-slate-100 bg-slate-50/50 hover:bg-white hover:shadow-lg transition-all cursor-pointer group/task relative\"\r\n                    >\r\n                      <div class=\"flex justify-between items-start mb-1\">\r\n                        <p class=\"text-[10px] font-black text-slate-800 leading-tight uppercase truncate pr-4\">{{ t.titulo_auto }}</p>\r\n                        <span class=\"text-[9px] font-black text-slate-400 uppercase\"> {{ t.etapa }}</span>\r\n                        <button v-if=\"can('producao.excluir')\" @click.stop=\"confirmarRemoverTarefa(t)\" class=\"opacity-0 group-hover/task:opacity-100 text-rose-400 hover:text-rose-600 transition-opacity absolute top-2 right-2\">\r\n                          <i class=\"pi pi-times-circle text-[12px]\"></i>\r\n                        </button>\r\n                      </div>\r\n\r\n                      <div class=\"flex flex-col gap-1 text-[9px] font-bold\">\r\n                        <span class=\"text-slate-400 flex items-center gap-1\">\r\n                          <i class=\"pi pi-clock text-[8px]\"></i> {{ Number(t.horas_total || 0).toFixed(1) }}h\r\n                        </span>\r\n                        <span class=\"text-emerald-600 font-black tracking-tight\">\r\n                          {{ format.currency(Number(t.custo_total || 0)) }}\r\n                        </span>\r\n                        <div class=\"mt-1 flex items-center gap-1\">\r\n                           <span class=\"px-1.5 py-0.5 rounded-md bg-slate-200 text-slate-600 text-[8px] uppercase font-black\">\r\n                             {{ t.status }}\r\n                           </span>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </section>\r\n      </div>\r\n    </div>\r\n\r\n    <Teleport to=\"body\">\r\n      <transition name=\"fade\">\r\n        <div v-if=\"tarefaModal.open\" class=\"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm\" @click.self=\"confirmarFecharModalTarefa\">\r\n          <div class=\"w-full max-w-2xl bg-white rounded-[3rem] shadow-2xl overflow-hidden border border-white/20\">\r\n            <header class=\"p-8 border-b border-slate-100 bg-slate-50/50 flex justify-between items-center\">\r\n              <div>\r\n                <p class=\"text-[10px] font-black uppercase tracking-[0.4em] text-slate-400 mb-1\">Gestão de Fábrica</p>\r\n                <h3 class=\"text-xl font-black italic uppercase text-slate-800 tracking-tight\">\r\n                  {{ tarefaModal.isEdit ? 'Editar Detalhes' : 'Agendar Nova Tarefa' }}\r\n                </h3>\r\n              </div>\r\n              <button @click=\"confirmarFecharModalTarefa\" class=\"w-12 h-12 rounded-full bg-white border border-slate-200 flex items-center justify-center hover:bg-rose-50 hover:text-rose-500 transition-all shadow-sm\">\r\n                <i class=\"pi pi-times\"></i>\r\n              </button>\r\n            </header>\r\n\r\n            <form class=\"p-8 grid grid-cols-12 gap-5\" @submit.prevent=\"confirmarSalvarTarefa\">\r\n              <div v-if=\"!tarefaModal.isEdit\" class=\"col-span-12\">\r\n                <SearchInput \r\n                   v-model=\"tarefaModal._origem_key\" \r\n                   mode=\"select\" \r\n                   label=\"Vincular ao Projeto/Origem *\" \r\n                   placeholder=\"Selecione o projeto de origem...\"\r\n                   :options=\"projetosOptions\" \r\n                   @update:modelValue=\"setOrigemFromKey\" \r\n                />\r\n              </div>\r\n\r\n              <div class=\"col-span-12 md:col-span-6\">\r\n                <SearchInput v-model=\"tarefaModal.funcionario_id\" mode=\"select\" label=\"Responsável\" placeholder=\"Quem vai executar?\" :options=\"funcionariosOptions\" />\r\n              </div>\r\n              <div class=\"col-span-12 md:col-span-6\">\r\n                <SearchInput v-model=\"tarefaModal.status\" mode=\"select\" label=\"Status Atual *\" :options=\"STATUS_TAREFA\" />\r\n              </div>\r\n              <div class=\"col-span-12\">\r\n                <Input v-model=\"tarefaModal.observacao\" label=\"Observações / Instruções\" placeholder=\"Detalhes técnicos...\" />\r\n              </div>\r\n\r\n              <div class=\"col-span-12 md:col-span-6\">\r\n                <Input v-model=\"tarefaModal.inicio_em\" type=\"datetime-local\" label=\"Início Previsto *\" />\r\n              </div>\r\n              <div class=\"col-span-12 md:col-span-6\">\r\n                <Input v-model=\"tarefaModal.fim_em\" type=\"datetime-local\" label=\"Finalização Prevista *\" />\r\n              </div>\r\n\r\n              <footer class=\"col-span-12 flex justify-end gap-3 mt-6\">\r\n                <Button variant=\"secondary\" type=\"button\" @click=\"confirmarFecharModalTarefa\">Descartar</Button>\r\n                <Button \r\n                   variant=\"primary\" \r\n                   type=\"submit\" \r\n                   :loading=\"savingTarefa\" \r\n                   :disabled=\"!podeSalvarTarefa\"\r\n                >\r\n                  <i class=\"pi pi-check mr-2\"></i>\r\n                  {{ tarefaModal.isEdit ? 'Salvar Alterações' : 'Confirmar Agendamento' }}\r\n                </Button>\r\n              </footer>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      </transition>\r\n    </Teleport>\r\n  </Card>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, computed, onMounted, watch } from 'vue'\r\nimport { ProducaoService, FuncionarioService } from '@/services/index'\r\nimport { format } from '@/utils/format'\r\nimport { confirm } from '@/services/confirm'\r\nimport { can } from '@/services/permissions'\r\nimport { notify } from '@/services/notify'\r\n\r\n\r\ndefinePage({ meta: { perm: 'producao.ver' } })\r\n\r\n\r\n// ===============================\r\n// GRADE FIXA (ajuste aqui)\r\n// ===============================\r\nconst SLOTS = [\r\n  '07:00', '08:00', '09:00', '10:00', '11:00',\r\n  '12:00', '13:00', '14:00', '15:00', '16:00', '17:00'\r\n] // <- você muda aqui\r\n\r\nconst STATUS_TAREFA = [\r\n  { label: 'PENDENTE', value: 'PENDENTE' },\r\n  { label: 'EM_ANDAMENTO', value: 'EM_ANDAMENTO' },\r\n  { label: 'FINALIZADA', value: 'FINALIZADA' },\r\n  { label: 'CANCELADA', value: 'CANCELADA' },\r\n]\r\n\r\n// ===============================\r\n// HELPERS DATA\r\n// ===============================\r\nfunction pad(n) { return String(n).padStart(2, '0') }\r\n\r\nfunction todayStr() {\r\n  const d = new Date()\r\n  return `${d.getFullYear()}-${pad(d.getMonth() + 1)}-${pad(d.getDate())}`\r\n}\r\n\r\nfunction addDays(dateStr, days) {\r\n  const d = new Date(`${dateStr}T00:00:00`)\r\n  d.setDate(d.getDate() + Number(days || 0))\r\n  return `${d.getFullYear()}-${pad(d.getMonth() + 1)}-${pad(d.getDate())}`\r\n}\r\n\r\nfunction toISOStartOfDay(dateStr) {\r\n  const d = new Date(`${dateStr}T00:00:00`)\r\n  return d.toISOString()\r\n}\r\nfunction toISOEndOfDay(dateStr) {\r\n  const d = new Date(`${dateStr}T23:59:59`)\r\n  return d.toISOString()\r\n}\r\n\r\nfunction texto(x) {\r\n  return String(x ?? '').toLowerCase().trim()\r\n}\r\n\r\nfunction isoToInputDateTime(iso) {\r\n  if (!iso) return ''\r\n  const d = new Date(iso)\r\n  if (Number.isNaN(d.getTime())) return ''\r\n  return `${d.getFullYear()}-${pad(d.getMonth() + 1)}-${pad(d.getDate())}T${pad(d.getHours())}:${pad(d.getMinutes())}`\r\n}\r\n\r\nfunction inputDateTimeToISO(v) {\r\n  if (!v) return null\r\n  const d = new Date(v)\r\n  if (Number.isNaN(d.getTime())) return null\r\n  return d.toISOString()\r\n}\r\n\r\nfunction slotToISO(dateStr, slotHHMM) {\r\n  return new Date(`${dateStr}T${slotHHMM}:00`).toISOString()\r\n}\r\n\r\nfunction plusHoursISO(iso, h = 2) {\r\n  const d = new Date(iso)\r\n  d.setHours(d.getHours() + h)\r\n  return d.toISOString()\r\n}\r\n\r\nfunction mesmaData(aISO, dateStr) {\r\n  const d = new Date(aISO)\r\n  const y = d.getFullYear()\r\n  const m = pad(d.getMonth() + 1)\r\n  const day = pad(d.getDate())\r\n  return `${y}-${m}-${day}` === dateStr\r\n}\r\n\r\nfunction horaStr(iso) {\r\n  const d = new Date(iso)\r\n  return `${pad(d.getHours())}:${pad(d.getMinutes())}`\r\n}\r\n\r\n// ===============================\r\n// STATE\r\n// ===============================\r\nconst loading = ref(true)\r\nconst refreshing = ref(false)\r\n\r\nconst semanaInicio = ref(todayStr()) // você escolhe a data\r\nconst semanaFim = computed(() => addDays(semanaInicio.value, 6))\r\n\r\nconst busca = ref('')\r\n\r\nconst projetosRaw = ref([]) // vem do endpoint atual\r\nconst funcionariosOptions = ref([])\r\n\r\nconst projetosPendentes = computed(() =>\r\n  (projetosRaw.value || []).filter((p) => p.encaminhado_em && (!p.tarefas || p.tarefas.length === 0))\r\n)\r\n\r\n\r\nconst tarefaModal = reactive({\r\n  open: false,\r\n  isEdit: false,\r\n  tarefaId: null,\r\n\r\n  // ✅ origem do projeto (obrigatório no create)\r\n  origem_tipo: '',\r\n  origem_id: 0,\r\n\r\n  funcionario_id: null,\r\n  titulo: '',\r\n  status: 'PENDENTE',\r\n  observacao: '',\r\n  inicio_em: '',\r\n  fim_em: '',\r\n})\r\n\r\n\r\nconst savingTarefa = ref(false)\r\nconst deletingTarefa = ref(false)\r\n\r\n// ===============================\r\n// DIAS (Seg–Sáb)\r\n// ===============================\r\nconst diasSemana = computed(() => {\r\n  const base = semanaInicio.value\r\n  const labels = ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'] // se você quiser só Seg–Sáb, removemos Dom no array\r\n  // aqui vou usar Seg–Sáb conforme você pediu:\r\n  return [0,1,2,3,4,5].map((i) => ({\r\n    key: `${base}-${i}`,\r\n    label: labels[i],\r\n    date: addDays(base, i),\r\n  }))\r\n})\r\n\r\nconst semanaLabel = computed(() => `${format.date(semanaInicio.value)} → ${format.date(semanaFim.value)}`)\r\nconst projetosOptions = computed(() => {\r\n  return (projetosRaw.value || []).map((p) => ({\r\n    label: `${p.codigo ? p.codigo + ' · ' : ''}${p.origem_tipo} #${p.origem_id}`,\r\n    value: `${p.origem_tipo}::${p.origem_id}`,\r\n  }))\r\n})\r\n\r\n\r\nfunction setOrigemFromKey(v) {\r\n  const s = String(v || '')\r\n  const [tipo, idStr] = s.split('::')\r\n  tarefaModal.origem_tipo = String(tipo || '').trim()\r\n  tarefaModal.origem_id = Number(idStr || 0)\r\n}\r\n\r\n// ===============================\r\n// FLATTEN tarefas (do retorno atual)\r\n// ===============================\r\nconst todasTarefas = computed(() => {\r\n  const out = []\r\n  for (const p of (projetosRaw.value || [])) {\r\n    const tituloAuto = montarTituloProjeto(p)\r\n\r\n    for (const t of (p.tarefas || [])) {\r\n      out.push({\r\n        ...t,\r\n        origem_tipo: p.origem_tipo,\r\n        origem_id: p.origem_id,\r\n        codigo: p.codigo,\r\n        titulo_auto: tituloAuto,\r\n      })\r\n    }\r\n  }\r\n  return out\r\n})\r\n\r\nfunction montarTituloProjeto(p) {\r\n  // VENDA_ITEM -> Cliente + Ambiente\r\n  const cliente =\r\n    p?.venda_item?.venda?.cliente?.nome_fantasia ||\r\n    p?.venda_item?.venda?.cliente?.nome_completo ||\r\n    p?.venda_item?.venda?.cliente?.razao_social ||\r\n    ''\r\n\r\n  const ambiente = p?.venda_item?.nome_ambiente || ''\r\n\r\n  if (cliente || ambiente) {\r\n    return [cliente, ambiente].filter(Boolean).join(' · ')\r\n  }\r\n\r\n  // PLANO_CORTE -> fornecedor (ou código)\r\n  const forn =\r\n    p?.plano_corte?.fornecedor?.nome_fantasia ||\r\n    p?.plano_corte?.fornecedor?.razao_social ||\r\n    ''\r\n\r\n  if (forn) return `PLANO DE CORTE · ${forn}`\r\n\r\n  // fallback\r\n  return `${p.codigo || ''} ${p.origem_tipo} #${p.origem_id}`.trim()\r\n}\r\n\r\n\r\nfunction abrirNovaTarefaDeProjeto(p) {\r\n  if (!can('producao.criar')) return notify.error('Acesso negado.')\r\n\r\n  tarefaModal.open = true\r\n  tarefaModal.isEdit = false\r\n  tarefaModal.tarefaId = null\r\n\r\n  tarefaModal.origem_tipo = p.origem_tipo\r\n  tarefaModal.origem_id = p.origem_id\r\n  tarefaModal._origem_key = `${p.origem_tipo}::${p.origem_id}`\r\n\r\n  tarefaModal.funcionario_id = null\r\n  tarefaModal.titulo = ''\r\n  tarefaModal.status = 'PENDENTE'\r\n  tarefaModal.observacao = ''\r\n  tarefaModal.inicio_em = ''\r\n  tarefaModal.fim_em = ''\r\n}\r\n\r\n\r\nconst tarefasFiltradas = computed(() => {\r\n  const q = texto(busca.value)\r\n  if (!q) return todasTarefas.value\r\n  return todasTarefas.value.filter((t) => {\r\n    const base =\r\n      `${t.id} ${t.titulo} ${t.status} ${t.funcionario?.nome || ''} ${t.funcionario_id} ${t.origem_tipo} ${t.origem_id}`.toLowerCase()\r\n    return base.includes(q)\r\n  })\r\n})\r\n\r\nconst totalCustoSemana = computed(() =>\r\n  tarefasFiltradas.value.reduce((acc, t) => acc + Number(t.custo_total || 0), 0)\r\n)\r\n\r\n// tarefas por slot = mesmas data + inicio dentro do slot (simples e operacional)\r\nfunction tarefasNoSlot(dateStr, slotHHMM) {\r\n  return tarefasFiltradas.value.filter((t) => {\r\n    if (!t.inicio_em) return false\r\n    if (!mesmaData(t.inicio_em, dateStr)) return false\r\n    return horaStr(t.inicio_em).slice(0, 2) === slotHHMM.slice(0, 2)\r\n  })\r\n}\r\n\r\n// ===============================\r\n// API\r\n// ===============================\r\nasync function carregarFuncionariosSelect(q = '') {\r\n  if (!can('funcionarios.select')) return\r\n  const { data } = await FuncionarioService.select(q)\r\n  funcionariosOptions.value = Array.isArray(data) ? data : []\r\n}\r\n\r\n\r\n\r\nasync function carregar() {\r\n  if (!can('producao.ver')) return  \r\n  refreshing.value = true\r\n  try {\r\n    const inicioIso = toISOStartOfDay(semanaInicio.value)\r\n    const fimIso = toISOEndOfDay(semanaFim.value)\r\n\r\n    const { data } = await ProducaoService.getAgenda(inicioIso, fimIso)\r\n\r\n    projetosRaw.value = Array.isArray(data) ? data : []\r\n  } finally {\r\n    refreshing.value = false\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// salvar (wrapper) - chama sua salvarTarefaModal real\r\nasync function confirmarSalvarTarefa() {\r\n  const perm = tarefaModal.isEdit ? 'producao.editar' : 'producao.criar'\r\n  if (!can(perm)) return notify.error('Acesso negado.')\r\n\r\n  if (!podeSalvarTarefa.value) return\r\n\r\n  const ok = await confirm.show(\r\n    tarefaModal.isEdit ? 'Salvar Alterações' : 'Criar Tarefa',\r\n    tarefaModal.isEdit\r\n      ? `Deseja salvar as alterações da tarefa \"${tarefaModal.titulo}\"?`\r\n      : `Deseja criar a tarefa \"${tarefaModal.titulo}\"?`,\r\n  )\r\n  if (!ok) return\r\n\r\n  await salvarTarefaModal()\r\n}\r\n\r\n// excluir (wrapper)\r\nasync function confirmarRemoverTarefa(row) {\r\n  if (!can('producao.excluir')) return notify.error('Acesso negado.')\r\n\r\n  if (!row?.id || deletingTarefa.value) return\r\n\r\n  const ok = await confirm.show(\r\n    'Excluir Tarefa',\r\n    `Deseja excluir a tarefa \"${row.titulo}\"? Esta ação não pode ser desfeita.`,\r\n  )\r\n  if (!ok) return\r\n\r\n  deletingTarefa.value = true\r\n  try {\r\n    await ProducaoService.tarefas.remover(row.id)\r\n    await carregar()\r\n  } finally {\r\n    deletingTarefa.value = false\r\n  }\r\n}\r\n\r\n// fechar modal (wrapper)\r\nasync function confirmarFecharModalTarefa() {\r\n  const ok = await confirm.show(\r\n    'Fechar',\r\n    'Deseja fechar o formulário da tarefa?',\r\n  )\r\n  if (!ok) return\r\n  fecharModalTarefa()\r\n}\r\n// ===============================\r\n// SEMANA NAV\r\n// ===============================\r\nfunction voltarSemana() {\r\n  semanaInicio.value = addDays(semanaInicio.value, -7)\r\n  carregar()\r\n}\r\nfunction avancarSemana() {\r\n  semanaInicio.value = addDays(semanaInicio.value, 7)\r\n  carregar()\r\n}\r\n\r\n// ===============================\r\n// MODAL\r\n// ===============================\r\nfunction abrirNovaTarefaSolta() {\r\n  if (!can('producao.criar')) return notify.error('Acesso negado.')\r\n\r\n  tarefaModal.open = true\r\n  tarefaModal.isEdit = false\r\n  tarefaModal.tarefaId = null\r\n\r\n  tarefaModal.origem_tipo = ''\r\n  tarefaModal.origem_id = 0\r\n  tarefaModal._origem_key = ''\r\n\r\n  tarefaModal.funcionario_id = null\r\n  tarefaModal.titulo = ''\r\n  tarefaModal.status = 'PENDENTE'\r\n  tarefaModal.observacao = ''\r\n  tarefaModal.inicio_em = ''\r\n  tarefaModal.fim_em = ''\r\n}\r\n\r\n\r\nfunction abrirNovaTarefaNoSlot(dateStr, slotHHMM) {\r\n  if (!can('producao.criar')) return notify.error('Acesso negado.')\r\n\r\n  const inicioIso = slotToISO(dateStr, slotHHMM)\r\n  const fimIso = plusHoursISO(inicioIso, 2)\r\n\r\n  tarefaModal.open = true\r\n  tarefaModal.isEdit = false\r\n  tarefaModal.tarefaId = null\r\n\r\n  tarefaModal.origem_tipo = ''\r\n  tarefaModal.origem_id = 0\r\n  tarefaModal._origem_key = ''\r\n\r\n  tarefaModal.funcionario_id = null\r\n  tarefaModal.titulo = ''\r\n  tarefaModal.status = 'PENDENTE'\r\n  tarefaModal.observacao = ''\r\n  tarefaModal.inicio_em = isoToInputDateTime(inicioIso)\r\n  tarefaModal.fim_em = isoToInputDateTime(fimIso)\r\n}\r\n\r\n\r\nfunction editarTarefa(row) {\r\n  if (!can('producao.editar')) return notify.error('Acesso negado.')\r\n\r\n  tarefaModal.open = true\r\n  tarefaModal.isEdit = true\r\n  tarefaModal.tarefaId = row.id\r\n  tarefaModal.funcionario_id = row.funcionario_id ?? null\r\n  tarefaModal.titulo = row.titulo ?? ''\r\n  tarefaModal.status = row.status ?? 'PENDENTE'\r\n  tarefaModal.observacao = row.observacao ?? ''\r\n  tarefaModal.inicio_em = isoToInputDateTime(row.inicio_em)\r\n  tarefaModal.fim_em = isoToInputDateTime(row.fim_em)\r\n}\r\n\r\nfunction fecharModalTarefa() {\r\n  tarefaModal.open = false\r\n}\r\n\r\nconst podeSalvarTarefa = computed(() => {\r\n  if (savingTarefa.value) return false\r\n\r\n  // ✅ origem obrigatória no create (e também no edit se você quiser)\r\n  if (!String(tarefaModal.origem_tipo || '').trim()) return false\r\n  if (!Number(tarefaModal.origem_id || 0)) return false\r\n\r\n  if (!String(tarefaModal.titulo || '').trim()) return false\r\n  if (!String(tarefaModal.inicio_em || '').trim()) return false\r\n  if (!String(tarefaModal.fim_em || '').trim()) return false\r\n\r\n  return true\r\n})\r\n\r\n\r\n// ⚠️ Como o endpoint atual usa origem_tipo/origem_id, aqui você mantém o que você já fazia.\r\n// Se você quer criar tarefa “solta” sem origem, aí sim é backend/Prisma (a gente faz depois).\r\nfunction montarPayloadCriarTarefa() {\r\n  return {\r\n    origem_tipo: String(tarefaModal.origem_tipo || '').trim(),\r\n    origem_id: Number(tarefaModal.origem_id || 0),\r\n\r\n    funcionario_id: tarefaModal.funcionario_id ? Number(tarefaModal.funcionario_id) : null,\r\n    titulo: String(tarefaModal.titulo || '').trim(),\r\n    status: String(tarefaModal.status || 'PENDENTE').trim(),\r\n    observacao: tarefaModal.observacao ? String(tarefaModal.observacao).trim() : null,\r\n    inicio_em: inputDateTimeToISO(tarefaModal.inicio_em),\r\n    fim_em: inputDateTimeToISO(tarefaModal.fim_em),\r\n  }\r\n}\r\n\r\n\r\n\r\nfunction montarPayloadAtualizarTarefa() {\r\n  return {\r\n    funcionario_id: Number(tarefaModal.funcionario_id),\r\n    titulo: String(tarefaModal.titulo || '').trim(),\r\n    status: String(tarefaModal.status || 'PENDENTE').trim(),\r\n    observacao: tarefaModal.observacao ? String(tarefaModal.observacao).trim() : null,\r\n    inicio_em: inputDateTimeToISO(tarefaModal.inicio_em),\r\n    fim_em: inputDateTimeToISO(tarefaModal.fim_em),\r\n  }\r\n}\r\n\r\nasync function salvarTarefaModal() {\r\n  if (!podeSalvarTarefa.value) return\r\n  savingTarefa.value = true\r\n  try {\r\n    if (tarefaModal.isEdit && tarefaModal.tarefaId) {\r\n      await ProducaoService.tarefas.atualizar(tarefaModal.tarefaId, montarPayloadAtualizarTarefa())\r\n    } else {\r\n      await ProducaoService.tarefas.criar(montarPayloadCriarTarefa())\r\n    }\r\n    fecharModalTarefa()\r\n    await carregar()\r\n  } finally {\r\n    savingTarefa.value = false\r\n  }\r\n}\r\n\r\nwatch(\r\n  () => semanaInicio.value,\r\n  async () => {\r\n    if (loading.value) return // evita rodar durante o primeiro load\r\n    await carregar()\r\n  }\r\n)\r\n\r\n\r\n\r\n// ===============================\r\n// INIT\r\n// ===============================\r\nonMounted(async () => {\r\n  await carregarFuncionariosSelect()\r\n  await carregar()\r\n})\r\n</script>\r\n"],"names":["SLOTS","STATUS_TAREFA","pad","n","todayStr","d","addDays","dateStr","days","toISOStartOfDay","toISOEndOfDay","texto","x","isoToInputDateTime","iso","inputDateTimeToISO","v","slotToISO","slotHHMM","plusHoursISO","h","mesmaData","aISO","y","m","day","horaStr","loading","ref","refreshing","semanaInicio","semanaFim","computed","busca","projetosRaw","funcionariosOptions","projetosPendentes","p","tarefaModal","reactive","savingTarefa","deletingTarefa","diasSemana","base","labels","semanaLabel","format","projetosOptions","setOrigemFromKey","s","tipo","idStr","todasTarefas","out","tituloAuto","montarTituloProjeto","t","cliente","_c","_b","_a","_f","_e","_d","_i","_h","_g","ambiente","_j","forn","_l","_k","_n","_m","abrirNovaTarefaDeProjeto","can","notify","tarefasFiltradas","q","totalCustoSemana","acc","tarefasNoSlot","carregarFuncionariosSelect","data","FuncionarioService","carregar","inicioIso","fimIso","ProducaoService","confirmarSalvarTarefa","perm","podeSalvarTarefa","confirm","salvarTarefaModal","confirmarRemoverTarefa","row","confirmarFecharModalTarefa","fecharModalTarefa","voltarSemana","avancarSemana","abrirNovaTarefaSolta","abrirNovaTarefaNoSlot","editarTarefa","montarPayloadCriarTarefa","montarPayloadAtualizarTarefa","watch","onMounted","_createBlock","_component_Card","_createVNode","_component_PageHeader","_createElementVNode","_hoisted_1","_component_Loading","_openBlock","_createElementBlock","_hoisted_2","_hoisted_3","_hoisted_4","_component_Input","$event","_component_SearchInput","_hoisted_5","_unref","_component_Button","_cache","_hoisted_6","_hoisted_7","_toDisplayString","_hoisted_8","_hoisted_9","_hoisted_10","_Fragment","_renderList","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","slot","_hoisted_24","_hoisted_25","_hoisted_27","_withModifiers","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_Teleport","_Transition","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","_hoisted_47"],"mappings":"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"}