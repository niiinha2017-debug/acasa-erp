import{f as g,g as k,h as G,j as x,i as H,m as O,s as f,y as K,E as V,C,x as Q,r as m,o as c,A as w,e as t,b as n,c as y,H as X,d as A,p as Z,F as T,u as v,I as Y,J as ee,K as ae,L as le,M as P,T as oe,N as se,l as L,t as ne,q as te}from"./index-CH22lQIC.js";import{b as ie,a as re}from"./utils-haS6CNYB.js";const de={class:"p-8 lg:p-12"},pe={class:"grid grid-cols-12 gap-6 items-end bg-slate-50/50 dark:bg-slate-800/20 p-6 rounded-2xl"},ue={class:"col-span-12 md:col-span-3 pb-2"},ce={class:"col-span-12 md:col-span-9"},me={class:"grid grid-cols-12 gap-6"},ve={class:"grid grid-cols-12 gap-6"},fe={class:"col-span-12 md:col-span-4"},be={class:"grid grid-cols-12 gap-6"},ge={class:"col-span-12 grid grid-cols-1 md:grid-cols-2 gap-4 bg-slate-50 dark:bg-slate-800/30 p-6 rounded-2xl border border-border-ui"},Ve={class:"col-span-12 md:col-span-4"},_e={class:"col-span-12 md:col-span-8"},xe={class:"grid grid-cols-12 gap-6"},Ce={class:"pt-10 mt-6 border-t border-border-ui"},we={class:"flex items-center justify-between gap-4"},ye={class:"relative flex items-center justify-center gap-2 font-bold tracking-wide text-white"},Ae={key:1},ke={__name:"[id]",setup(Ee){const R=Q(),E=K(),I=g(!1),_=g(!1),j=g(!1),d=g(!1),U=g([]),b=k(()=>{var s;return Number((s=R.params)==null?void 0:s.id)}),u=k(()=>!!b.value),B=[{value:"",label:"SELECIONE..."},{value:"SOLTEIRO",label:"SOLTEIRO"},{value:"CASADO",label:"CASADO"},{value:"DIVORCIADO",label:"DIVORCIADO"},{value:"VIUVO",label:"VIÚVO(A)"}],h=[{value:"ATIVO",label:"ATIVO"},{value:"INATIVO",label:"INATIVO"},{value:"PENDENTE",label:"PENDENTE"},{value:"BLOQUEADO",label:"BLOQUEADO"}],e=G({indicacao_id:null,nome_completo:"",razao_social:"",nome_fantasia:"",data_nascimento:"",cpf:"",rg:"",cnpj:"",ie:"",telefone:"",whatsapp:"",estado_civil:"",nome_conjuge:"",email:"",enviar_aniversario_email:!0,enviar_aniversario_whatsapp:!1,cep:"",endereco:"",numero:"",complemento:"",bairro:"",cidade:"",estado:"",status:"ATIVO"}),z=k(()=>U.value.filter(s=>!u.value||Number(s.value)!==b.value));async function N(){var a;if(((a=e.cep)==null?void 0:a.length)<9)return;const s=await re(e.cep);s&&(e.endereco=s.logradouro||e.endereco,e.bairro=s.bairro||e.bairro,e.cidade=s.localidade||e.cidade,e.estado=s.uf||e.estado)}async function $(){var a;if(((a=e.cnpj)==null?void 0:a.length)<18)return;const s=await ie(e.cnpj);s&&(e.nome_completo=s.razao_social||s.nome||e.nome_completo,e.nome_fantasia=s.nome_fantasia||s.fantasia||e.nome_fantasia,e.email=s.email||e.email,e.cep=s.cep||e.cep,N())}async function F(){var s;try{I.value=!0;const a=await C.select();if(U.value=Array.isArray(a==null?void 0:a.data)?a.data:[],u.value){const r=await C.buscar(b.value);if(r!=null&&r.data){const o=r.data;Object.assign(e,{indicacao_id:o.indicacao_id||null,nome_completo:o.nome_completo||"",razao_social:o.razao_social||"",nome_fantasia:o.nome_fantasia||"",data_nascimento:((s=o.data_nascimento)==null?void 0:s.split("T")[0])||"",cpf:o.cpf||"",rg:o.rg||"",cnpj:o.cnpj||"",ie:o.ie||"",telefone:o.telefone||"",whatsapp:o.whatsapp||"",estado_civil:o.estado_civil||"",nome_conjuge:o.nome_conjuge||"",email:o.email||"",enviar_aniversario_email:!!o.enviar_aniversario_email,enviar_aniversario_whatsapp:!!o.enviar_aniversario_whatsapp,cep:o.cep||"",endereco:o.endereco||"",numero:o.numero||"",complemento:o.complemento||"",bairro:o.bairro||"",cidade:o.cidade||"",estado:o.estado||"",status:o.status||"ATIVO"}),d.value=!!o.cnpj}}}catch(a){console.error("Erro ao carregar dados:",a),f.error("Erro ao carregar dados.")}finally{I.value=!1}}x(d,s=>{s?(e.cpf="",e.rg=""):(e.cnpj="",e.ie="",e.nome_fantasia="")}),x(()=>e.email,s=>{e.email=String(s||"").toLowerCase().trim(),e.email||(e.enviar_aniversario_email=!1)}),x(()=>e.whatsapp,s=>{s||(e.enviar_aniversario_whatsapp=!1)}),x(()=>e.estado_civil,s=>{s!=="CASADO"&&(e.nome_conjuge="")});async function J(){var a,r;if(_.value)return;const s=u.value?"clientes.editar":"clientes.criar";if(!O(s)){f.error("Acesso negado.");return}_.value=!0;try{const o={...e,data_nascimento:e.data_nascimento?e.data_nascimento:null,razao_social:d.value?e.nome_completo:null,email:e.email?String(e.email).toLowerCase().trim():null,nome_conjuge:e.estado_civil==="CASADO"&&e.nome_conjuge||null,enviar_aniversario_email:e.email?!!e.enviar_aniversario_email:!1,enviar_aniversario_whatsapp:e.whatsapp?!!e.enviar_aniversario_whatsapp:!1,indicacao_id:e.indicacao_id?Number(e.indicacao_id):null};d.value?(delete o.cpf,delete o.rg):(delete o.cnpj,delete o.ie,delete o.razao_social),await C.salvar(u.value?Number(b.value):null,o),f.success(u.value?"Cliente atualizado!":"Cliente cadastrado!"),await E.push("/clientes")}catch(o){const p=(r=(a=o==null?void 0:o.response)==null?void 0:a.data)==null?void 0:r.message;f.error(Array.isArray(p)?p.join(" | "):p||"Erro ao salvar.")}finally{_.value=!1}}async function M(){var a,r;if(await te.show("Excluir Cliente?","Esta ação não pode ser desfeita.")){j.value=!0;try{await C.remover(Number(b.value)),f.success("Cliente removido!"),E.push("/clientes")}catch(o){console.error("Erro ao excluir:",o);const p=(r=(a=o==null?void 0:o.response)==null?void 0:a.data)==null?void 0:r.message;f.error(Array.isArray(p)?p.join(" | "):p||"Erro ao excluir.")}finally{j.value=!1}}}return H(async()=>{const s=u.value?"clientes.editar":"clientes.criar";if(!O(s)){f.error("Acesso negado."),E.push("/clientes");return}await F()}),(s,a)=>{const r=m("PageHeader"),o=m("Loading"),p=m("CustomCheckbox"),q=m("SearchInput"),i=m("Input"),S=m("Select"),D=m("Button"),W=m("Card");return c(),V(W,{class:"mt-4 mb-8 mx-2 lg:mx-4 shadow-xl rounded-[2.5rem] overflow-hidden animate-page-in"},{default:w(()=>[t(r,{title:u.value?`Editar Cliente #${b.value}`:"Novo Cliente",subtitle:"Gerenciamento de dados cadastrais e contato",icon:"pi pi-user-plus",backTo:"/clientes",class:"border-b border-border-ui"},null,8,["title"]),n("div",de,[I.value?(c(),V(o,{key:0})):(c(),y("form",{key:1,class:"space-y-10",onSubmit:X(J,["prevent"]),autocomplete:"off"},[n("div",pe,[n("div",ue,[t(p,{modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=l=>d.value=l),label:"Pessoa Jurídica"},null,8,["modelValue"])]),n("div",ce,[t(q,{modelValue:e.indicacao_id,"onUpdate:modelValue":a[1]||(a[1]=l=>e.indicacao_id=l),mode:"select",label:"Quem indicou?",placeholder:"Pesquisar cliente existente...",options:z.value,labelKey:"label",valueKey:"value"},null,8,["modelValue","options"])])]),a[35]||(a[35]=n("div",{class:"relative"},[n("div",{class:"absolute inset-0 flex items-center"},[n("div",{class:"w-full border-t border-border-ui/50"})]),n("div",{class:"relative flex justify-center"},[n("span",{class:"bg-bg-page dark:bg-slate-900 px-4 text-xs font-bold uppercase tracking-wider text-slate-400"}," Dados Principais ")])],-1)),n("div",me,[t(i,{class:Z(d.value?"col-span-12 md:col-span-6":"col-span-12 md:col-span-9"),modelValue:e.nome_completo,"onUpdate:modelValue":a[2]||(a[2]=l=>e.nome_completo=l),label:d.value?"Razão Social":"Nome Completo",placeholder:"Digite o nome principal...",required:"","force-upper":""},null,8,["class","modelValue","label"]),d.value?(c(),V(i,{key:0,class:"col-span-12 md:col-span-3",modelValue:e.nome_fantasia,"onUpdate:modelValue":a[3]||(a[3]=l=>e.nome_fantasia=l),label:"Nome Fantasia",placeholder:"Opcional","force-upper":""},null,8,["modelValue"])):A("",!0),t(i,{class:"col-span-12 md:col-span-3",modelValue:e.data_nascimento,"onUpdate:modelValue":a[4]||(a[4]=l=>e.data_nascimento=l),label:d.value?"Data de Abertura":"Data de Nascimento",type:"date"},null,8,["modelValue","label"])]),n("div",ve,[d.value?(c(),y(T,{key:1},[t(i,{class:"col-span-12 md:col-span-4",modelValue:e.cnpj,"onUpdate:modelValue":a[9]||(a[9]=l=>e.cnpj=l),label:"CNPJ",placeholder:"00.000.000/0000-00",onInput:a[10]||(a[10]=l=>e.cnpj=v(ae)(e.cnpj)),onBlur:$},null,8,["modelValue"]),t(i,{class:"col-span-12 md:col-span-4",modelValue:e.ie,"onUpdate:modelValue":a[11]||(a[11]=l=>e.ie=l),label:"IE",placeholder:"Inscrição Estadual",onInput:a[12]||(a[12]=l=>e.ie=v(le)(e.ie))},null,8,["modelValue"])],64)):(c(),y(T,{key:0},[t(i,{class:"col-span-12 md:col-span-4",modelValue:e.cpf,"onUpdate:modelValue":a[5]||(a[5]=l=>e.cpf=l),label:"CPF",placeholder:"000.000.000-00",onInput:a[6]||(a[6]=l=>e.cpf=v(Y)(e.cpf))},null,8,["modelValue"]),t(i,{class:"col-span-12 md:col-span-4",modelValue:e.rg,"onUpdate:modelValue":a[7]||(a[7]=l=>e.rg=l),label:"RG",placeholder:"00.000.000-0",onInput:a[8]||(a[8]=l=>e.rg=v(ee)(e.rg))},null,8,["modelValue"])],64)),n("div",fe,[t(S,{modelValue:e.status,"onUpdate:modelValue":a[13]||(a[13]=l=>e.status=l),label:"Status",options:h,"force-upper":"",required:""},null,8,["modelValue"])])]),a[36]||(a[36]=n("div",{class:"relative"},[n("div",{class:"absolute inset-0 flex items-center"},[n("div",{class:"w-full border-t border-border-ui/50"})]),n("div",{class:"relative flex justify-center"},[n("span",{class:"bg-bg-page dark:bg-slate-900 px-4 text-xs font-bold uppercase tracking-wider text-slate-400"}," Contato ")])],-1)),n("div",be,[t(i,{class:"col-span-12 md:col-span-4",modelValue:e.email,"onUpdate:modelValue":a[14]||(a[14]=l=>e.email=l),label:"E-mail",type:"email",placeholder:"ex: nome@dominio.com","force-upper":!1},null,8,["modelValue"]),t(i,{class:"col-span-12 md:col-span-4",modelValue:e.whatsapp,"onUpdate:modelValue":a[15]||(a[15]=l=>e.whatsapp=l),label:"WhatsApp",placeholder:"(00) 00000-0000",onInput:a[16]||(a[16]=l=>e.whatsapp=v(P)(e.whatsapp))},null,8,["modelValue"]),t(i,{class:"col-span-12 md:col-span-4",modelValue:e.telefone,"onUpdate:modelValue":a[17]||(a[17]=l=>e.telefone=l),label:"Fixo",placeholder:"(00) 0000-0000",onInput:a[18]||(a[18]=l=>e.telefone=v(P)(e.telefone))},null,8,["modelValue"]),n("div",ge,[t(p,{modelValue:e.enviar_aniversario_email,"onUpdate:modelValue":a[19]||(a[19]=l=>e.enviar_aniversario_email=l),label:"Aviso por E-mail",description:e.email?"Será enviado para o e-mail cadastrado":"Cadastre um e-mail primeiro",disabled:!e.email},null,8,["modelValue","description","disabled"]),t(p,{modelValue:e.enviar_aniversario_whatsapp,"onUpdate:modelValue":a[20]||(a[20]=l=>e.enviar_aniversario_whatsapp=l),label:"Aviso por WhatsApp",description:e.whatsapp?"Será enviado para o WhatsApp cadastrado":"Cadastre um WhatsApp primeiro",disabled:!e.whatsapp},null,8,["modelValue","description","disabled"])]),n("div",Ve,[t(S,{modelValue:e.estado_civil,"onUpdate:modelValue":a[21]||(a[21]=l=>e.estado_civil=l),label:"Estado Civil",options:B,"force-upper":""},null,8,["modelValue"])]),n("div",_e,[t(oe,{name:"slide-fade"},{default:w(()=>[e.estado_civil==="CASADO"?(c(),V(i,{key:0,modelValue:e.nome_conjuge,"onUpdate:modelValue":a[22]||(a[22]=l=>e.nome_conjuge=l),label:"Nome do Cônjuge",placeholder:"Digite o nome completo do cônjuge","force-upper":""},null,8,["modelValue"])):A("",!0)]),_:1})])]),a[37]||(a[37]=n("div",{class:"relative"},[n("div",{class:"absolute inset-0 flex items-center"},[n("div",{class:"w-full border-t border-border-ui/50"})]),n("div",{class:"relative flex justify-center"},[n("span",{class:"bg-bg-page dark:bg-slate-900 px-4 text-xs font-bold uppercase tracking-wider text-slate-400"}," Endereço ")])],-1)),n("div",xe,[t(i,{class:"col-span-12 md:col-span-3",modelValue:e.cep,"onUpdate:modelValue":a[23]||(a[23]=l=>e.cep=l),label:"CEP",placeholder:"00000-000",onInput:a[24]||(a[24]=l=>e.cep=v(se)(e.cep)),onBlur:N},null,8,["modelValue"]),t(i,{class:"col-span-12 md:col-span-7",modelValue:e.endereco,"onUpdate:modelValue":a[25]||(a[25]=l=>e.endereco=l),label:"Logradouro",placeholder:"Rua, Avenida, etc...","force-upper":""},null,8,["modelValue"]),t(i,{class:"col-span-12 md:col-span-2",modelValue:e.numero,"onUpdate:modelValue":a[26]||(a[26]=l=>e.numero=l),label:"Nº",placeholder:"123","force-upper":""},null,8,["modelValue"]),t(i,{class:"col-span-12 md:col-span-4",modelValue:e.bairro,"onUpdate:modelValue":a[27]||(a[27]=l=>e.bairro=l),label:"Bairro",placeholder:"Ex: Centro","force-upper":""},null,8,["modelValue"]),t(i,{class:"col-span-12 md:col-span-5",modelValue:e.cidade,"onUpdate:modelValue":a[28]||(a[28]=l=>e.cidade=l),label:"Cidade",placeholder:"Ex: São Paulo","force-upper":""},null,8,["modelValue"]),t(i,{class:"col-span-12 md:col-span-3",modelValue:e.estado,"onUpdate:modelValue":a[29]||(a[29]=l=>e.estado=l),label:"UF (Estado)",placeholder:"Ex: SP","force-upper":""},null,8,["modelValue"]),t(i,{class:"col-span-12",modelValue:e.complemento,"onUpdate:modelValue":a[30]||(a[30]=l=>e.complemento=l),label:"Complemento / Referência",placeholder:"Apt, Bloco, Próximo a...","force-upper":""},null,8,["modelValue"])]),n("div",Ce,[n("div",we,[a[34]||(a[34]=n("div",null,null,-1)),t(D,{variant:"primary",size:"lg",type:"submit",loading:_.value,class:"!rounded-xl px-8 py-3 bg-gradient-to-r from-brand-primary to-brand-primary/90 hover:from-brand-primary hover:to-brand-primary hover:shadow-2xl hover:shadow-brand-primary/30 active:scale-[0.98] transition-all duration-300 group relative overflow-hidden"},{default:w(()=>[a[32]||(a[32]=n("div",{class:"absolute inset-0 bg-gradient-to-r from-white/20 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700"},null,-1)),n("span",ye,[a[31]||(a[31]=n("i",{class:"pi pi-save text-[14px] group-hover:rotate-12 transition-transform"},null,-1)),L(" "+ne(u.value?"ATUALIZAR CLIENTE":"CADASTRAR CLIENTE"),1)])]),_:1},8,["loading"]),u.value&&v(O)("clientes.excluir")?(c(),V(D,{key:0,type:"button",variant:"danger",size:"lg",loading:j.value,onClick:M},{default:w(()=>[...a[33]||(a[33]=[n("i",{class:"pi pi-trash mr-2 text-[12px]"},null,-1),L(" EXCLUIR ",-1)])]),_:1},8,["loading"])):A("",!0),u.value?A("",!0):(c(),y("div",Ae))])])],32))])]),_:1})}}};export{ke as default};
//# sourceMappingURL=_id_-BtRnw1Dd.js.map
