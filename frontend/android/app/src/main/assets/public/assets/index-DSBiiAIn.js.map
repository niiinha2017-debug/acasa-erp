{"version":3,"file":"index-DSBiiAIn.js","sources":["../../src/pages/fornecedor/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"w-full max-w-[1200px] mx-auto space-y-4 animate-page-in\">\r\n    \r\n    <div class=\"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 p-2\">\r\n      <div class=\"flex items-center gap-3\">\r\n        <div class=\"w-10 h-10 rounded-xl bg-slate-900 text-white flex items-center justify-center\">\r\n          <i class=\"pi pi-truck text-lg\"></i>\r\n        </div>\r\n        <div>\r\n          <h1 class=\"text-lg font-black text-slate-800 uppercase tracking-tight\">Fornecedores</h1>\r\n          <p class=\"text-[10px] font-bold text-slate-400 uppercase tracking-wider\">Gestão de parceiros comerciais</p>\r\n        </div>\r\n      </div>\r\n      \r\n      <div class=\"flex flex-col sm:flex-row items-center gap-2 w-full sm:w-auto\">\r\n        <div class=\"relative w-full sm:w-64\">\r\n          <i class=\"pi pi-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-xs\"></i>\r\n          <input \r\n            v-model=\"busca\" \r\n            type=\"text\" \r\n            placeholder=\"Buscar por razão, cnpj ou cidade...\"\r\n            class=\"w-full pl-9 pr-3 h-10 bg-white border border-slate-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-brand-primary/10 focus:border-brand-primary outline-none transition-all uppercase\"\r\n          />\r\n        </div>\r\n        \r\n<Button\r\n  v-if=\"can('fornecedores.criar')\"\r\n  variant=\"primary\"\r\n  size=\"md\"\r\n  class=\"!h-10 !rounded-xl !px-4 text-xs font-black uppercase tracking-wider w-full sm:w-auto\"\r\n  @click=\"router.push('/fornecedor/novo')\"\r\n>\r\n          <i class=\"pi pi-plus mr-1.5 text-[10px]\"></i>\r\n          Novo\r\n        </Button>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"grid grid-cols-2 lg:grid-cols-4 gap-3\">\r\n      <div class=\"p-4 rounded-xl bg-white border border-slate-200 shadow-sm\">\r\n        <p class=\"text-[9px] font-black uppercase tracking-[0.15em] text-slate-400\">Total Parceiros</p>\r\n        <p class=\"text-xl font-black text-slate-800\">{{ rows.length }}</p>\r\n      </div>\r\n      \r\n      <div class=\"p-4 rounded-xl bg-white border border-blue-200 shadow-sm\">\r\n        <p class=\"text-[9px] font-black uppercase tracking-[0.15em] text-blue-600\">Com E-mail</p>\r\n        <p class=\"text-xl font-black text-blue-700\">{{ rows.filter(r => r.email).length }}</p>\r\n      </div>\r\n      \r\n      <div class=\"p-4 rounded-xl bg-white border border-emerald-200 shadow-sm\">\r\n        <p class=\"text-[9px] font-black uppercase tracking-[0.15em] text-emerald-600\">Estados Atendidos</p>\r\n        <p class=\"text-xl font-black text-emerald-700\">{{ new Set(rows.map(r => r.estado).filter(Boolean)).size }}</p>\r\n      </div>\r\n      \r\n      <div class=\"p-4 rounded-xl bg-white border border-amber-200 shadow-sm\">\r\n        <p class=\"text-[9px] font-black uppercase tracking-[0.15em] text-amber-600\">Novos (Mês)</p>\r\n        <p class=\"text-xl font-black text-amber-700\">{{ rows.slice(0, 5).length }}</p>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"rounded-xl border border-slate-200 bg-white overflow-hidden shadow-sm\">\r\n      <Table\r\n        :columns=\"columns\"\r\n        :rows=\"rowsFiltrados\"\r\n        :loading=\"loading\"\r\n        empty-text=\"Nenhum parceiro comercial encontrado.\"\r\n        :boxed=\"false\"\r\n      >\r\n        <template #cell-razao_social=\"{ row }\">\r\n          <div class=\"py-1\">\r\n            <span class=\"text-sm font-bold text-slate-800 block uppercase tracking-tight\">\r\n              {{ row.razao_social }}\r\n            </span>\r\n<span class=\"text-sm font-medium text-slate-600 tabular-nums\">\r\n  {{ row.cnpj ? maskCNPJ(row.cnpj) : '—' }}\r\n</span>\r\n\r\n          </div>\r\n        </template>\r\n\r\n        <template #cell-cnpj=\"{ row }\">\r\n          <span class=\"text-sm font-medium text-slate-600 tabular-nums\">\r\n            {{ row.cnpj || '—' }}\r\n          </span>\r\n        </template>\r\n\r\n        <template #cell-contato=\"{ row }\">\r\n          <div class=\"flex flex-col\">\r\n            <span class=\"text-[11px] font-bold text-slate-500 lowercase\">\r\n              {{ row.email || 'sem e-mail' }}\r\n            </span>\r\n<span class=\"text-[10px] font-black text-brand-primary uppercase mt-0.5\">\r\n  {{ row.whatsapp ? maskTelefone(row.whatsapp) : (row.telefone ? maskTelefone(row.telefone) : '—') }}\r\n</span>\r\n\r\n          </div>\r\n        </template>\r\n\r\n        <template #cell-comercial=\"{ row }\">\r\n          <div class=\"flex flex-col\">\r\n            <span class=\"px-2 py-0.5 rounded bg-slate-100 text-[9px] font-black text-slate-600 uppercase w-fit mb-1\">\r\n              {{ row.forma_pagamento || 'A COMBINAR' }}\r\n            </span>\r\n            <div v-if=\"row.data_vencimento\" class=\"flex items-center gap-1 text-amber-600\">\r\n              <i class=\"pi pi-calendar text-[10px]\"></i>\r\n              <span class=\"text-[9px] font-black uppercase\">Dia {{ row.data_vencimento }}</span>\r\n            </div>\r\n          </div>\r\n        </template>\r\n\r\n        <template #cell-acoes=\"{ row }\">\r\n          <div class=\"flex justify-end gap-1\">\r\n<button\r\n  v-if=\"can('fornecedores.editar')\"\r\n  @click=\"editar(row.id)\"\r\n              class=\"w-7 h-7 rounded-lg bg-slate-100 text-slate-500 hover:bg-brand-primary hover:text-white transition-all flex items-center justify-center\"\r\n            >\r\n              <i class=\"pi pi-pencil text-xs\"></i>\r\n            </button>\r\n\r\n<button\r\n  v-if=\"can('fornecedores.excluir')\"\r\n  @click=\"confirmarExclusao(row.id)\"\r\n              class=\"w-7 h-7 rounded-lg bg-red-50 text-red-500 hover:bg-red-500 hover:text-white transition-all flex items-center justify-center\"\r\n            >\r\n              <i class=\"pi pi-trash text-xs\"></i>\r\n            </button>\r\n          </div>\r\n        </template>\r\n      </Table>\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { FornecedorService } from '@/services/index'\r\nimport { notify } from '@/services/notify'\r\nimport { confirm } from '@/services/confirm'\r\nimport { maskCNPJ, maskTelefone } from '@/utils/masks'\r\n\r\n\r\nimport { can } from '@/services/permissions'\r\n\r\ndefinePage({ meta: { perm: 'fornecedores.ver' } })\r\n\r\n\r\nconst router = useRouter()\r\nconst loading = ref(false)\r\nconst busca = ref('')\r\nconst rows = ref([])\r\n\r\nconst columns = [\r\n  { key: 'razao_social', label: 'Fornecedor', width: '35%' },\r\n  { key: 'cnpj', label: 'CNPJ', width: '20%' },\r\n  { key: 'contato', label: 'Contato', width: '25%' },\r\n  { key: 'comercial', label: 'Comercial', width: '15%' },\r\n  { key: 'acoes', label: '', width: '5%', align: 'right' },\r\n]\r\n\r\nconst rowsFiltrados = computed(() => {\r\n  const q = String(busca.value || '').trim().toLowerCase()\r\n  if (!q) return rows.value\r\n\r\n  return rows.value.filter((r) => {\r\n    const alvo = [\r\n      r.razao_social,\r\n      r.nome_fantasia,\r\n      r.cnpj,\r\n      r.email,\r\n      r.telefone,\r\n      r.whatsapp,\r\n      r.cidade,\r\n      r.estado,\r\n    ]\r\n      .filter(Boolean)\r\n      .join(' ')\r\n      .toLowerCase()\r\n\r\n    return alvo.includes(q)\r\n  })\r\n})\r\n\r\nfunction editar(id) {\r\n  if (!can('fornecedores.editar')) return notify.error('Acesso negado.')\r\n  router.push(`/fornecedor/${id}`)\r\n}\r\n\r\n\r\n\r\nasync function confirmarExclusao(id) {\r\n  if (!can('fornecedores.excluir')) return notify.error('Acesso negado.')\r\n  \r\n  const fornecedor = rows.value.find(r => r.id === id)\r\n  const ok = await confirm.show(\r\n    'Excluir Fornecedor',\r\n    `Deseja excluir \"${fornecedor?.razao_social || `Fornecedor #${id}`}\"? Esta ação é permanente.`\r\n  )\r\n  if (!ok) return\r\n\r\n  try {\r\n    await FornecedorService.remover(id)\r\n    rows.value = rows.value.filter((r) => r.id !== id)\r\n    notify.success('Fornecedor removido.')\r\n  } catch (e) {\r\n    notify.error('Erro ao excluir fornecedor.')\r\n  }\r\n}\r\n\r\nasync function carregar() {\r\n  loading.value = true\r\n  try {\r\n    const { data } = await FornecedorService.listar()\r\n    rows.value = Array.isArray(data) ? data : []\r\n  } catch (e) {\r\n    notify.error('Erro ao carregar fornecedores.')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nonMounted(carregar)\r\n</script>"],"names":["router","useRouter","loading","ref","busca","rows","columns","rowsFiltrados","computed","q","r","editar","id","can","notify","confirmarExclusao","fornecedor","confirm","FornecedorService","carregar","data","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","$event","_unref","_createBlock","_component_Button","_cache","_hoisted_5","_hoisted_6","_hoisted_7","_toDisplayString","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_createVNode","_component_Table","_withCtx","row","_hoisted_15","_hoisted_16","_hoisted_17","maskCNPJ","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","maskTelefone","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26"],"mappings":"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"}