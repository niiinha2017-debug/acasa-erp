import{_ as G,f,g as H,i as J,r as T,c as x,u,o as c,b as s,d as k,k as K,E as O,m as i,A as g,l as j,w as Q,v as W,e as y,p as D,t as p,H as X,F as Y,$ as C,s as r,q as A}from"./index-CH22lQIC.js";import{u as Z}from"./useauth-BQLIh4i2.js";const ee={class:"w-full max-w-[1200px] mx-auto space-y-6 animate-page-in pb-20"},ae={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 p-2"},te={class:"bg-white border border-slate-200 rounded-2xl shadow-sm overflow-hidden"},se={class:"p-6 border-b border-slate-100 bg-slate-50/30"},oe={class:"max-w-md relative group"},re={class:"overflow-x-auto"},le={class:"flex items-center gap-3 py-1"},ie={class:"w-9 h-9 rounded-lg flex items-center justify-center text-[10px] font-black border bg-slate-50 text-slate-500 border-slate-100"},ne={class:"flex flex-col"},ue={class:"font-black text-slate-700 uppercase text-[10px] tracking-tight leading-none"},de={class:"flex flex-col"},ce={class:"text-[10px] font-black text-slate-600 tracking-tight"},pe={class:"text-[9px] font-medium text-slate-400 lowercase"},ve=["disabled","onClick"],me={key:1,class:"text-[9px] font-black uppercase tracking-widest text-slate-400"},fe={class:"flex gap-1 justify-end"},xe=["onClick"],be=["onClick"],ge={key:0,class:"fixed inset-0 z-[100] flex items-center justify-center p-4"},he={class:"relative w-full max-w-lg animate-in zoom-in-95 duration-200"},ke={class:"bg-white rounded-2xl shadow-2xl overflow-hidden border border-slate-200"},ye={class:"px-8 py-5 border-b border-slate-100 flex justify-between items-center bg-slate-50/50"},_e={class:"text-[11px] font-black text-slate-800 uppercase tracking-widest"},we={class:"grid grid-cols-2 gap-4"},Ce={class:"flex justify-end gap-3 pt-4 border-t border-slate-100"},Ae={key:1,class:"h-[60vh] flex flex-col items-center justify-center gap-3"},Ee={__name:"usuarios",setup(Se){const{usuarioLogado:m,isAuthenticated:$}=Z(),h=f([]),E=f(""),_=f(!1),d=f(!1),S=f(!1),V=f(!1),L=[{key:"nome",label:"Colaborador"},{key:"acesso",label:"Login"},{key:"status",label:"Status"},{key:"acoes",label:"Ações"}],o=f({id:null,nome:"",usuario:"",email:"",senha:"",status:"PENDENTE"}),U=async()=>{S.value=!0;try{const{data:a}=await C.listar();h.value=Array.isArray(a)?a:[]}catch{r.error("Erro ao carregar lista")}finally{S.value=!1}},I=(a=null)=>{if(a){if(!i("usuarios.editar"))return r.error("Acesso negado.")}else if(!i("usuarios.criar"))return r.error("Acesso negado.");d.value=!!a,a?o.value={id:a.id,nome:a.nome||"",usuario:a.usuario||"",email:a.email||"",senha:"",status:a.status||"PENDENTE"}:o.value={id:null,nome:"",usuario:"",email:"",senha:"",status:"PENDENTE"},_.value=!0},M=()=>{_.value=!1};async function N(){await A.show("Cancelar","Deseja fechar sem salvar as alterações deste formulário?")&&M()}async function z(){const a=d.value?"usuarios.editar":"usuarios.criar";if(!i(a))return r.error("Acesso negado.");const e=d.value?"Salvar Alterações":"Criar Colaborador",l=d.value?`Deseja salvar as alterações do colaborador "${o.value.nome}"?`:`Deseja criar o colaborador "${o.value.nome}"?`;await A.show(e,l)&&await B()}const B=async()=>{const a=d.value?"usuarios.editar":"usuarios.criar";if(!i(a))return r.error("Acesso negado.");V.value=!0;try{await C.salvar(o.value.id,o.value),r.success("Operação realizada com sucesso!"),_.value=!1,await U()}catch{r.error("Erro ao salvar dados")}finally{V.value=!1}};async function P(a){var t;if(!i("usuarios.editar"))return r.error("Acesso negado.");if(a.id===((t=m.value)==null?void 0:t.id))return;const e=String(a.status||"").toUpperCase(),n=(e==="ATIVO"?"INATIVO":"ATIVO")==="ATIVO"?e==="PENDENTE"?"aprovar":"ativar":"inativar";await A.show("Alterar Status",`Deseja ${n} o colaborador "${a.nome}"?`)&&await R(a)}const R=async a=>{var n;if(!i("usuarios.editar"))return r.error("Acesso negado.");if(a.id===((n=m.value)==null?void 0:n.id))return;const l=String(a.status||"").toUpperCase()==="ATIVO"?"INATIVO":"ATIVO";try{await C.atualizarStatus(a.id,l),a.status=l,r.success(`Usuário ${l.toLowerCase()}!`)}catch{r.error("Erro ao alterar status")}},F=async a=>{var l;if(!i("usuarios.excluir"))return r.error("Acesso negado.");if(!(a.id===((l=m.value)==null?void 0:l.id)||!await A.show("Excluir",`Remover ${a.nome}?`)))try{await C.remover(a.id),h.value=h.value.filter(n=>n.id!==a.id),r.success("Removido com sucesso")}catch{r.error("Erro ao excluir")}},q=H(()=>{const a=String(E.value||"").toLowerCase().trim();return a?h.value.filter(e=>String((e==null?void 0:e.nome)||"").toLowerCase().includes(a)||String((e==null?void 0:e.email)||"").toLowerCase().includes(a)||String((e==null?void 0:e.usuario)||"").toLowerCase().includes(a)):h.value});return J(U),(a,e)=>{const l=T("Button"),n=T("Table"),b=T("Input");return u($)&&u(m)?(c(),x(Y,{key:0},[s("div",ee,[s("div",ae,[e[7]||(e[7]=K('<div class="flex items-center gap-3" data-v-68b278f9><div class="w-10 h-10 rounded-xl bg-slate-900 text-white flex items-center justify-center" data-v-68b278f9><i class="pi pi-users text-lg" data-v-68b278f9></i></div><div data-v-68b278f9><h1 class="text-lg font-black text-slate-800 uppercase tracking-tight" data-v-68b278f9>Gestão de Equipe</h1><p class="text-[10px] font-bold text-slate-400 uppercase tracking-wider flex items-center gap-2" data-v-68b278f9><span class="w-1.5 h-1.5 rounded-full bg-emerald-500" data-v-68b278f9></span> Operadores ativos no sistema </p></div></div>',1)),u(i)("usuarios.criar")?(c(),O(l,{key:0,variant:"primary",class:"!h-11 !rounded-xl !px-6 text-[10px] font-black uppercase tracking-widest shadow-sm",onClick:e[0]||(e[0]=t=>I())},{default:g(()=>[...e[6]||(e[6]=[s("i",{class:"pi pi-user-plus mr-2 text-[10px]"},null,-1),j(" Novo Colaborador ",-1)])]),_:1})):k("",!0)]),s("div",te,[s("div",se,[s("div",oe,[e[8]||(e[8]=s("i",{class:"pi pi-search absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 text-xs"},null,-1)),Q(s("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>E.value=t),placeholder:"BUSCAR POR NOME, E-MAIL OU USUÁRIO...",class:"w-full h-11 pl-11 pr-4 bg-white border border-slate-200 rounded-xl text-[10px] font-bold uppercase focus:ring-4 focus:ring-brand-primary/5 focus:border-brand-primary outline-none transition-all"},null,512),[[W,E.value]])])]),s("div",re,[y(n,{columns:L,rows:q.value,loading:S.value},{"cell-nome":g(({row:t})=>{var v;return[s("div",le,[s("div",ie,p((v=t.nome)==null?void 0:v.charAt(0).toUpperCase()),1),s("div",ne,[s("span",ue,p(t.nome),1),s("span",{class:D(["text-[9px] font-bold uppercase tracking-tighter mt-1",t.status==="ATIVO"?"text-emerald-600":t.status==="PENDENTE"?"text-amber-600":"text-rose-600"])},p(t.status),3)])])]}),"cell-acesso":g(({row:t})=>[s("div",de,[s("span",ce,"@"+p(t.usuario),1),s("span",pe,p(t.email),1)])]),"cell-status":g(({row:t})=>{var v,w;return[u(i)("usuarios.editar")?(c(),x("button",{key:0,disabled:t.id===((v=u(m).value)==null?void 0:v.id),onClick:Ve=>P(t),class:D(["px-3 py-1 rounded-md text-[8px] font-black uppercase tracking-widest border transition-all",t.status==="ATIVO"?"bg-emerald-50 text-emerald-600 border-emerald-100 hover:bg-emerald-600 hover:text-white":t.status==="PENDENTE"?"bg-amber-50 text-amber-700 border-amber-200 hover:bg-amber-600 hover:text-white":"bg-rose-50 text-rose-600 border-rose-100 hover:bg-rose-600 hover:text-white",t.id===((w=u(m).value)==null?void 0:w.id)?"opacity-30 cursor-not-allowed":"cursor-pointer"])},p(t.status),11,ve)):(c(),x("span",me,p(t.status),1))]}),"cell-acoes":g(({row:t})=>{var v;return[s("div",fe,[u(i)("usuarios.editar")?(c(),x("button",{key:0,onClick:w=>I(t),class:"w-8 h-8 rounded-lg text-slate-400 hover:bg-slate-100 hover:text-slate-800 transition-colors flex items-center justify-center"},[...e[9]||(e[9]=[s("i",{class:"pi pi-pencil text-[10px]"},null,-1)])],8,xe)):k("",!0),u(i)("usuarios.excluir")&&t.id!==((v=u(m).value)==null?void 0:v.id)?(c(),x("button",{key:1,onClick:w=>F(t),class:"w-8 h-8 rounded-lg text-slate-300 hover:bg-rose-50 hover:text-rose-600 transition-colors flex items-center justify-center"},[...e[10]||(e[10]=[s("i",{class:"pi pi-trash text-[10px]"},null,-1)])],8,be)):k("",!0)])]}),_:1},8,["rows","loading"])])])]),_.value?(c(),x("div",ge,[s("div",{class:"absolute inset-0 bg-slate-900/40 backdrop-blur-[2px]",onClick:N}),s("div",he,[s("div",ke,[s("header",ye,[s("h3",_e,p(d.value?"Editar Colaborador":"Novo Colaborador"),1),s("button",{onClick:N,class:"text-slate-400 hover:text-rose-500 transition-colors"},[...e[11]||(e[11]=[s("i",{class:"pi pi-times"},null,-1)])])]),s("form",{class:"p-8 space-y-5",onSubmit:X(z,["prevent"])},[s("div",we,[y(b,{modelValue:o.value.nome,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.nome=t),label:"Nome Completo",class:"col-span-2"},null,8,["modelValue"]),y(b,{modelValue:o.value.usuario,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.usuario=t),label:"Usuário Login",forceUpper:!1},null,8,["modelValue"]),y(b,{modelValue:o.value.email,"onUpdate:modelValue":e[4]||(e[4]=t=>o.value.email=t),label:"E-mail",type:"email",forceUpper:!1},null,8,["modelValue"]),y(b,{modelValue:o.value.senha,"onUpdate:modelValue":e[5]||(e[5]=t=>o.value.senha=t),label:d.value?"Nova Senha (deixe vazio para manter)":"Senha Inicial",type:"password",class:"col-span-2",forceUpper:!1},null,8,["modelValue","label"])]),s("div",Ce,[s("button",{type:"button",onClick:N,class:"text-[10px] font-black uppercase text-slate-400 hover:text-slate-600 px-4"}," Cancelar "),u(i)(d.value?"usuarios.editar":"usuarios.criar")?(c(),O(l,{key:0,variant:"primary",type:"submit",loading:V.value,class:"!h-10 !rounded-xl !px-8 text-[10px] font-black uppercase tracking-widest"},{default:g(()=>[j(p(d.value?"Salvar Alterações":"Criar Conta"),1)]),_:1},8,["loading"])):k("",!0)])],32)])])])):k("",!0)],64)):(c(),x("div",Ae,[...e[12]||(e[12]=[s("div",{class:"w-12 h-12 border-4 border-slate-100 border-t-brand-primary rounded-full animate-spin"},null,-1),s("span",{class:"text-[10px] font-black uppercase tracking-[0.3em] text-slate-400"},"Sincronizando...",-1)])]))}}},Ue=G(Ee,[["__scopeId","data-v-68b278f9"]]);export{Ue as default};
//# sourceMappingURL=usuarios-0v91YiEQ.js.map
