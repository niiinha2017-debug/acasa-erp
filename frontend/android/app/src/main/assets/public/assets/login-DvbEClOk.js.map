{"version":3,"file":"login-DvbEClOk.js","sources":["../../../../../pwa-192.png","../../src/pages/login.vue"],"sourcesContent":["export default \"__VITE_PUBLIC_ASSET__f55c4452__\"","<template>\r\n  <div class=\"h-dvh overflow-hidden bg-slate-50 text-slate-900 dark:bg-slate-950 dark:text-slate-50\">\r\n    <div class=\"fixed inset-0 pointer-events-none\">\r\n      <div class=\"absolute inset-0 bg-[radial-gradient(ellipse_at_top,rgba(99,102,241,0.10),transparent_55%)] dark:bg-[radial-gradient(ellipse_at_top,rgba(99,102,241,0.16),transparent_55%)]\" />\r\n      <div class=\"absolute inset-0 bg-[radial-gradient(ellipse_at_bottom,rgba(236,72,153,0.08),transparent_60%)] dark:bg-[radial-gradient(ellipse_at_bottom,rgba(236,72,153,0.12),transparent_60%)]\" />\r\n    </div>\r\n\r\n    <div class=\"relative h-dvh grid place-items-center p-4\">\r\n      <div class=\"w-full max-w-[520px] overflow-hidden rounded-3xl border border-slate-200/80 bg-white/85 shadow-[0_26px_70px_-40px_rgba(2,6,23,0.55)] backdrop-blur dark:border-slate-800/70 dark:bg-slate-950/60\">\r\n        \r\n        <div class=\"px-7 py-6 border-b border-slate-200/70 dark:border-slate-800/70\">\r\n          <div class=\"flex items-center gap-4\">\r\n            <div class=\"grid size-12 place-items-center rounded-2xl bg-white/80 ring-1 ring-slate-200 shadow-sm backdrop-blur dark:bg-slate-900/50 dark:ring-slate-800\">\r\n              <img src=\"/pwa-192.png\" alt=\"Logo\" class=\"size-8 object-contain\" />\r\n            </div>\r\n            <div class=\"flex-1\">\r\n              <p class=\"text-[10px] font-black uppercase tracking-[0.32em] text-slate-500 dark:text-slate-400\">sistema</p>\r\n              <h1 class=\"text-xl md:text-2xl font-black tracking-tight\">\r\n                A Casa <span class=\"text-indigo-600 dark:text-indigo-400\">Móveis Planejados.</span>\r\n              </h1>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"px-7 py-6\">\r\n          <form autocomplete=\"off\" @submit.prevent=\"handleLoginSubmit\" class=\"space-y-5\">\r\n            <div class=\"grid gap-4\">\r\n              <Input\r\n                v-model=\"formLogin.usuario\"\r\n                name=\"acasa_login_user\"\r\n                label=\"Usuário ou E-mail\"\r\n                class=\"h-11\"\r\n                :forceUpper=\"false\"\r\n                :disabled=\"loading\"\r\n              />\r\n\r\n              <Input\r\n                v-model=\"formLogin.senha\"\r\n                name=\"acasa_login_pass\"\r\n                autocomplete=\"current-password\"\r\n                :type=\"showPassword ? 'text' : 'password'\"\r\n                label=\"Senha\"\r\n                class=\"h-11\"\r\n                :forceUpper=\"false\"\r\n                :disabled=\"loading\"\r\n              >\r\n                <template #suffix>\r\n                  <button type=\"button\" @click=\"togglePassword\" class=\"rounded-xl px-2 py-2 text-slate-500 hover:text-indigo-600 dark:text-slate-400\">\r\n                    <i :class=\"showPassword ? 'pi pi-eye-slash' : 'pi pi-eye'\" class=\"text-base\" />\r\n                  </button>\r\n                </template>\r\n              </Input>\r\n            </div>\r\n\r\n            <div class=\"flex items-center justify-between gap-4\">\r\n              <CustomCheckbox v-model=\"lembrarUsuario\" label=\"Lembrar\" />\r\n              <button type=\"button\" @click=\"openRecuperacao\" class=\"text-xs font-black uppercase text-indigo-600 dark:text-indigo-400\">\r\n                Esqueci a senha\r\n              </button>\r\n            </div>\r\n\r\n            <div v-if=\"error\" class=\"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm font-semibold text-rose-700 dark:border-rose-900/40 dark:bg-rose-950/30 dark:text-rose-200\">\r\n              {{ error }}\r\n            </div>\r\n\r\n            <Button type=\"submit\" :loading=\"loading\" fullWidth class=\"h-11 rounded-2xl font-black uppercase tracking-[0.25em]\" :disabled=\"loading || !canSubmit\">\r\n              Entrar\r\n            </Button>\r\n\r\n            <div class=\"pt-4 border-t border-slate-200/70 dark:border-slate-800/70 text-center\">\r\n              <p class=\"text-xs text-slate-400 dark:text-slate-500\">\r\n                © {{ new Date().getFullYear() }} A Casa Móveis Planejados.\r\n              </p>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n\r\n      <Teleport to=\"body\">\r\n        <Transition name=\"fade-scale\">\r\n          <div v-if=\"showModalRecuperacao\" class=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\r\n            <div class=\"absolute inset-0 bg-black/55 backdrop-blur-sm\" @click=\"fecharTudo\"></div>\r\n            <div class=\"relative w-full max-w-md overflow-hidden rounded-3xl border border-slate-200 bg-white shadow-2xl dark:border-slate-800 dark:bg-slate-950\">\r\n              <div class=\"px-6 py-5 border-b border-slate-200/70 dark:border-slate-800/70 flex items-center justify-between\">\r\n                <div>\r\n                  <p class=\"text-[10px] font-black uppercase tracking-[0.35em] text-slate-500\">recuperação</p>\r\n                  <h3 class=\"text-lg font-black tracking-tight\">Recuperar senha</h3>\r\n                </div>\r\n                <button @click=\"fecharTudo\" class=\"rounded-xl p-2 text-slate-400 hover:text-rose-500\">\r\n                  <i class=\"pi pi-times text-lg\"></i>\r\n                </button>\r\n              </div>\r\n              <div class=\"px-6 py-6\">\r\n                <form @submit.prevent=\"handleRecuperacaoSubmit\" class=\"space-y-4\">\r\n                  <Input v-model=\"emailRecuperacao\" label=\"E-mail de acesso\" type=\"email\" required :forceUpper=\"false\" :disabled=\"loading\" />\r\n                  <p class=\"text-sm text-slate-600 dark:text-slate-400\">Enviaremos uma senha provisória para seu e-mail.</p>\r\n                  <div class=\"flex gap-3 pt-2\">\r\n                    <Button type=\"button\" variant=\"secondary\" @click=\"fecharTudo\" class=\"flex-1 h-11 rounded-2xl\">Cancelar</Button>\r\n                    <Button type=\"submit\" :loading=\"loading\" class=\"flex-1 h-11 rounded-2xl font-black uppercase tracking-[0.25em]\">Enviar</Button>\r\n                  </div>\r\n                </form>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </Transition>\r\n      </Teleport>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted, watch, computed } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { useAuth } from '@/services/useauth'\r\n\r\ndefinePage({ meta: { public: true, layout: 'auth' } })\r\n\r\nconst router = useRouter()\r\nconst { login, esqueciSenha, loading } = useAuth()\r\n\r\nconst showModalRecuperacao = ref(false)\r\nconst lembrarUsuario = ref(false)\r\nconst formLogin = reactive({ usuario: '', senha: '' })\r\nconst emailRecuperacao = ref('')\r\nconst showPassword = ref(false)\r\nconst error = ref('')\r\n\r\nconst togglePassword = () => { showPassword.value = !showPassword.value }\r\nconst canSubmit = computed(() => (formLogin.usuario || '').trim().length >= 3 && (formLogin.senha || '').length >= 3)\r\n\r\nonMounted(() => {\r\n  const salvo = localStorage.getItem('erp_lembrar_usuario')\r\n  if (salvo) { formLogin.usuario = salvo; lembrarUsuario.value = true }\r\n})\r\n\r\nfunction fecharTudo() { showModalRecuperacao.value = false; emailRecuperacao.value = '' }\r\nfunction openRecuperacao() { error.value = ''; showModalRecuperacao.value = true }\r\n\r\nasync function handleLoginSubmit() {\r\n  error.value = ''\r\n  try {\r\n    const data = await login({ usuario: formLogin.usuario, senha: formLogin.senha })\r\n    if (lembrarUsuario.value) localStorage.setItem('erp_lembrar_usuario', formLogin.usuario)\r\n    else localStorage.removeItem('erp_lembrar_usuario')\r\n\r\n    // Lógica crucial: Se a senha for provisória, manda trocar\r\n    if (data?.precisa_trocar_senha) {\r\n      router.push('/alterar-senha')\r\n    } else {\r\n      router.push('/')\r\n    }\r\n  } catch (e) {\r\n    error.value = 'Usuário ou senha inválidos.'\r\n  }\r\n}\r\n\r\nasync function handleRecuperacaoSubmit() {\r\n  try {\r\n    await esqueciSenha(emailRecuperacao.value)\r\n    fecharTudo()\r\n    alert('Enviamos uma senha provisória para seu e-mail.')\r\n  } catch (e) {}\r\n}\r\n\r\nwatch(lembrarUsuario, (v) => { if (!v) localStorage.removeItem('erp_lembrar_usuario') })\r\n</script>"],"names":["_imports_0","router","useRouter","login","esqueciSenha","loading","useAuth","showModalRecuperacao","ref","lembrarUsuario","formLogin","reactive","emailRecuperacao","showPassword","error","togglePassword","canSubmit","computed","onMounted","salvo","fecharTudo","openRecuperacao","handleLoginSubmit","data","handleRecuperacaoSubmit","watch","v","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_createVNode","_component_Input","_cache","$event","_unref","_normalizeClass","_hoisted_6","_component_CustomCheckbox","_hoisted_7","_toDisplayString","_component_Button","_hoisted_8","_hoisted_9","_createBlock","_Teleport","_Transition","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13"],"mappings":"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"}