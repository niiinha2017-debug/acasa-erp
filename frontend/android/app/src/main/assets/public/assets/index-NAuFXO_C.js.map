{"version":3,"file":"index-NAuFXO_C.js","sources":["../../src/pages/financeiro/contas-pagar/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"p-6 bg-slate-50 min-h-screen\">\r\n    \r\n    <header class=\"flex justify-between items-end mb-8\">\r\n      <div>\r\n        <h1 class=\"text-2xl font-black text-slate-800 uppercase italic tracking-tighter\">Contas a Pagar</h1>\r\n        <p class=\"text-xs text-slate-500 font-bold uppercase\">Gestão Consolidada de Saídas</p>\r\n      </div>\r\n      \r\n      <div class=\"flex gap-3\">\r\n        <button @click=\"abrirModalFechamento\" class=\"bg-slate-900 text-white px-4 py-2 rounded-lg font-black text-[10px] uppercase italic hover:bg-slate-800 transition-all shadow-lg\">\r\n          Novo Fechamento Mensal\r\n        </button>\r\n      </div>\r\n    </header>\r\n\r\n    <section class=\"bg-white p-4 rounded-xl shadow-sm border border-slate-200 mb-6 flex gap-4 items-end\">\r\n      <div class=\"flex-1 max-w-sm\">\r\n        <label class=\"text-[10px] font-black text-slate-400 uppercase mb-1 block\">Fornecedor</label>\r\n        <select v-model=\"filtros.fornecedor_id\" class=\"w-full bg-slate-50 border border-slate-200 rounded-lg p-2 text-xs font-bold uppercase outline-none focus:border-blue-500\">\r\n          <option value=\"\">TODOS OS FORNECEDORES</option>\r\n          <option v-for=\"o in fornecedorOptions\" :key=\"o.value\" :value=\"o.value\">{{ o.label }}</option>\r\n        </select>\r\n      </div>\r\n\r\n      <div class=\"w-48\">\r\n        <label class=\"text-[10px] font-black text-slate-400 uppercase mb-1 block\">Status</label>\r\n        <select v-model=\"filtros.status\" class=\"w-full bg-slate-50 border border-slate-200 rounded-lg p-2 text-xs font-bold uppercase outline-none focus:border-blue-500\">\r\n          <option value=\"EM_ABERTO\">EM ABERTO</option>\r\n          <option value=\"VENCIDO\">VENCIDOS</option>\r\n          <option value=\"PAGO\">PAGOS</option>\r\n        </select>\r\n      </div>\r\n\r\n      <button @click=\"buscar\" class=\"bg-blue-600 text-white p-2.5 rounded-lg hover:bg-blue-700 transition-all\">\r\n        <i class=\"pi pi-search text-sm\"></i>\r\n      </button>\r\n    </section>\r\n\r\n    <div class=\"bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden\">\r\n      <table class=\"w-full text-left border-collapse\">\r\n        <thead class=\"bg-slate-800 text-white\">\r\n          <tr>\r\n            <th v-for=\"col in columns\" :key=\"col.key\" :style=\"{ width: col.width, textAlign: col.align }\" class=\"p-4 text-[10px] font-black uppercase tracking-widest\">\r\n              {{ col.label }}\r\n            </th>\r\n          </tr>\r\n        </thead>\r\n        <tbody class=\"divide-y divide-slate-100\">\r\n          <tr v-for=\"row in rows\" :key=\"`${row.origem}-${row.id}`\" class=\"hover:bg-slate-50 transition-colors group\">\r\n            <td class=\"p-4 italic font-black text-[9px]\">\r\n               <span :class=\"getOrigemClass(row.origem)\" class=\"px-2 py-1 rounded border\">{{ row.origem }}</span>\r\n            </td>\r\n            <td class=\"p-4 font-black text-sm text-slate-700\">{{ formatarData(row.vencimento_em) }}</td>\r\n            <td class=\"p-4 font-black text-sm uppercase italic text-slate-800\">\r\n              {{ row.fornecedor_nome || 'DESPESA OPERACIONAL' }}\r\n              <div class=\"text-[9px] text-slate-400 not-italic\">{{ row.descricao }}</div>\r\n            </td>\r\n            <td class=\"p-4 text-right font-black italic\">{{ formatarMoeda(row.valor) }}</td>\r\n            <td class=\"p-4 uppercase font-black text-[10px]\">\r\n              <span :class=\"getStatusClass(row.status)\" class=\"px-2 py-1 rounded-full border\">{{ row.status }}</span>\r\n            </td>\r\n            \r\n            <td class=\"p-4 text-right\">\r\n              <div class=\"flex justify-end gap-2\">\r\n                <button \r\n                  v-if=\"row.status !== 'PAGO'\"\r\n                  @click=\"darBaixa(row)\"\r\n                  class=\"h-7 px-3 rounded bg-emerald-500 text-white text-[9px] font-black uppercase hover:bg-emerald-600 shadow-sm\"\r\n                >\r\n                  Pagar\r\n                </button>\r\n                <button class=\"w-7 h-7 rounded bg-slate-100 text-slate-400 hover:bg-slate-900 hover:text-white transition-all\">\r\n                  <i class=\"pi pi-eye text-[10px]\"></i>\r\n                </button>\r\n              </div>\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n\r\n      <div v-if=\"!loading && rows.length === 0\" class=\"p-20 text-center\">\r\n        <i class=\"pi pi-inbox text-4xl text-slate-200 mb-4 block\"></i>\r\n        <p class=\"text-slate-400 font-bold uppercase italic text-xs\">Nenhum registro encontrado</p>\r\n      </div>\r\n    </div>\r\n\r\n    <ModalFechamento \r\n      v-if=\"modalFechamentoOpen\"\r\n      :open=\"modalFechamentoOpen\"\r\n      :preview=\"fornecedorSelecionadoParaFechamento\"\r\n      :fornecedorNome=\"nomeFornecedorFechamento\"\r\n      @close=\"modalFechamentoOpen = false\"\r\n      @confirm=\"executarFechamentoFinal\"\r\n    />\r\n\r\n  </div>\r\n</template>\r\n\r\n\r\n\r\n<script setup>\r\nimport { computed, onMounted, reactive, ref } from 'vue'\r\nimport { FinanceiroService, FornecedorService } from '@/services/index'\r\nimport { notify } from '@/services/notify'\r\nimport { confirm } from '@/services/confirm'\r\n\r\n\r\n\r\n// =======================\r\n// STATE\r\n// =======================\r\nconst loading = ref(false)\r\nconst rows = ref([])\r\nconst fornecedorOptions = ref([])\r\n\r\nconst filtros = reactive({\r\n  fornecedor_id: '',\r\n  status: 'EM_ABERTO', // Padrão para não poluir\r\n})\r\n\r\nconst columns = [\r\n  { key: 'origem', label: 'ORIGEM', width: '100px' },\r\n  { key: 'vencimento', label: 'VENCIMENTO', width: '120px' },\r\n  { key: 'fornecedor', label: 'FORNECEDOR/DESCRIÇÃO' },\r\n  { key: 'valor', label: 'VALOR TOTAL', width: '140px', align: 'right' },\r\n  { key: 'status', label: 'STATUS', width: '100px' },\r\n  { key: 'acoes', label: '', width: '80px', align: 'right' },\r\n]\r\n\r\n\r\n// Adicione ao seu state\r\nconst modalFechamentoOpen = ref(false)\r\nconst fornecedorSelecionadoParaFechamento = ref(null)\r\n\r\n// Função para abrir o modal de fechamento\r\nasync function abrirModalFechamento() {\r\n  if (!filtros.fornecedor_id) {\r\n    return notify.warn('Selecione um fornecedor para iniciar o fechamento')\r\n  }\r\n  \r\n  try {\r\n    loading.value = true\r\n    // Busca o preview do backend (Etapa 1 do seu Service)\r\n    const previewData = await FinanceiroService.previewFechamentoFornecedor({\r\n      fornecedor_id: filtros.fornecedor_id,\r\n      mes: new Date().getMonth() + 1,\r\n      ano: new Date().getFullYear()\r\n    })\r\n    \r\n    fornecedorSelecionadoParaFechamento.value = previewData\r\n    modalFechamentoOpen.value = true\r\n  } catch (e) {\r\n    notify.error('Não foi possível gerar o preview de fechamento')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// Função de Baixa Rápida (Ação de Pagar)\r\nasync function darBaixa(item) {\r\n  const confirmacao = await confirm(`Deseja confirmar o pagamento de ${formatarMoeda(item.valor)}?`)\r\n  \r\n  if (confirmacao) {\r\n    try {\r\n      // Chama o método pagarContaPagar do seu Service\r\n      await FinanceiroService.pagarContaPagar(item.id, {\r\n        unidade: 'FÁBRICA',\r\n        categoria: 'PAGAMENTO_FORNECEDOR'\r\n      })\r\n      notify.success('Pagamento registrado com sucesso!')\r\n      buscar() // Recarrega a lista\r\n    } catch (e) {\r\n      notify.error('Erro ao registrar pagamento')\r\n    }\r\n  }\r\n}\r\n// =======================\r\n// MÉTODOS\r\n// =======================\r\nasync function buscar() {\r\n  try {\r\n    loading.value = true\r\n    const data = await FinanceiroService.listarContasPagarConsolidado(filtros)\r\n    rows.value = data || []\r\n  } catch (e) {\r\n    notify.error('Erro ao carregar contas a pagar')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst formatarMoeda = (v) => v.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })\r\nconst formatarData = (v) => v ? new Date(v).toLocaleDateString('pt-BR') : '-'\r\n\r\n// Estilização dinâmica de badges\r\nconst getStatusClass = (status) => {\r\n  const map = {\r\n    'EM_ABERTO': 'bg-blue-100 text-blue-700 border-blue-200',\r\n    'VENCIDO': 'bg-rose-100 text-rose-700 border-rose-200 animate-pulse',\r\n    'PAGO': 'bg-emerald-100 text-emerald-700 border-emerald-200',\r\n  }\r\n  return map[status] || 'bg-slate-100 text-slate-700'\r\n}\r\n\r\nconst getOrigemClass = (origem) => {\r\n  const map = {\r\n    'DESPESA': 'text-purple-600 bg-purple-50 border-purple-100',\r\n    'COMPRA': 'text-orange-600 bg-orange-50 border-orange-100',\r\n    'FECHAMENTO': 'text-blue-600 bg-blue-50 border-blue-100',\r\n  }\r\n  return map[origem] || 'text-slate-600 bg-slate-50'\r\n}\r\n\r\nonMounted(async () => {\r\n  const forns = await FornecedorService.listarAtivos()\r\n  fornecedorOptions.value = forns.map(f => ({ label: f.nome_fantasia, value: f.id }))\r\n  buscar()\r\n})\r\n</script>"],"names":["loading","ref","rows","fornecedorOptions","filtros","reactive","columns","modalFechamentoOpen","fornecedorSelecionadoParaFechamento","abrirModalFechamento","notify","previewData","FinanceiroService","darBaixa","item","confirm","formatarMoeda","buscar","data","v","formatarData","getStatusClass","status","getOrigemClass","origem","onMounted","forns","FornecedorService","f","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_cache","$event","_Fragment","_renderList","o","_toDisplayString","_hoisted_4","_vModelSelect","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","col","_hoisted_9","row","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_createBlock","_component_ModalFechamento","nomeFornecedorFechamento","executarFechamentoFinal"],"mappings":"ygCAgHA,MAAMA,EAAUC,EAAI,EAAK,EACnBC,EAAOD,EAAI,EAAE,EACbE,EAAoBF,EAAI,EAAE,EAE1BG,EAAUC,EAAS,CACvB,cAAe,GACf,OAAQ,WACV,CAAC,EAEKC,EAAU,CACd,CAAE,IAAK,SAAU,MAAO,SAAU,MAAO,OAAO,EAChD,CAAE,IAAK,aAAc,MAAO,aAAc,MAAO,OAAO,EACxD,CAAE,IAAK,aAAc,MAAO,sBAAsB,EAClD,CAAE,IAAK,QAAS,MAAO,cAAe,MAAO,QAAS,MAAO,OAAO,EACpE,CAAE,IAAK,SAAU,MAAO,SAAU,MAAO,OAAO,EAChD,CAAE,IAAK,QAAS,MAAO,GAAI,MAAO,OAAQ,MAAO,OAAO,CAC1D,EAIMC,EAAsBN,EAAI,EAAK,EAC/BO,EAAsCP,EAAI,IAAI,EAGpD,eAAeQ,GAAuB,CACpC,GAAI,CAACL,EAAQ,cACX,OAAOM,EAAO,KAAK,mDAAmD,EAGxE,GAAI,CACFV,EAAQ,MAAQ,GAEhB,MAAMW,EAAc,MAAMC,EAAkB,4BAA4B,CACtE,cAAeR,EAAQ,cACvB,IAAK,IAAI,OAAO,SAAQ,EAAK,EAC7B,IAAK,IAAI,KAAI,EAAG,YAAW,CACjC,CAAK,EAEDI,EAAoC,MAAQG,EAC5CJ,EAAoB,MAAQ,EAC9B,MAAY,CACVG,EAAO,MAAM,gDAAgD,CAC/D,QAAC,CACCV,EAAQ,MAAQ,EAClB,CACF,CAGA,eAAea,EAASC,EAAM,CAG5B,GAFoB,MAAMC,EAAQ,mCAAmCC,EAAcF,EAAK,KAAK,CAAC,GAAG,EAG/F,GAAI,CAEF,MAAMF,EAAkB,gBAAgBE,EAAK,GAAI,CAC/C,QAAS,UACT,UAAW,sBACnB,CAAO,EACDJ,EAAO,QAAQ,mCAAmC,EAClDO,EAAM,CACR,MAAY,CACVP,EAAO,MAAM,6BAA6B,CAC5C,CAEJ,CAIA,eAAeO,GAAS,CACtB,GAAI,CACFjB,EAAQ,MAAQ,GAChB,MAAMkB,EAAO,MAAMN,EAAkB,6BAA6BR,CAAO,EACzEF,EAAK,MAAQgB,GAAQ,CAAA,CACvB,MAAY,CACVR,EAAO,MAAM,iCAAiC,CAChD,QAAC,CACCV,EAAQ,MAAQ,EAClB,CACF,CAEA,MAAMgB,EAAiBG,GAAMA,EAAE,eAAe,QAAS,CAAE,MAAO,WAAY,SAAU,MAAO,EACvFC,EAAgBD,GAAMA,EAAI,IAAI,KAAKA,CAAC,EAAE,mBAAmB,OAAO,EAAI,IAGpEE,EAAkBC,IACV,CACV,UAAa,4CACb,QAAW,0DACX,KAAQ,oDACZ,GACaA,CAAM,GAAK,8BAGlBC,EAAkBC,IACV,CACV,QAAW,iDACX,OAAU,iDACV,WAAc,0CAClB,GACaA,CAAM,GAAK,6BAGxB,OAAAC,EAAU,SAAY,CACpB,MAAMC,EAAQ,MAAMC,EAAkB,aAAY,EAClDxB,EAAkB,MAAQuB,EAAM,IAAIE,IAAM,CAAE,MAAOA,EAAE,cAAe,MAAOA,EAAE,EAAE,EAAG,EAClFX,EAAM,CACR,CAAC,uCAzNC,OAAAY,EAAA,EAAAC,EA+FM,MA/FNC,EA+FM,CA7FJC,EAWS,SAAA,CAXD,MAAM,qCAAqC,EAAA,aACjDA,EAGM,MAAA,KAAA,CAFJA,EAAoG,KAAA,CAAhG,MAAM,sEAAsE,EAAC,gBAAc,EAC/FA,EAAsF,IAAA,CAAnF,MAAM,4CAA4C,EAAC,8BAA4B,QAGpFA,EAIM,MAAA,CAJD,MAAM,YAAY,EAAA,CACrBA,EAES,SAAA,CAFA,QAAOvB,EAAsB,MAAM,oIAAmI,0BAE/K,MAIJuB,EAqBU,UArBVC,EAqBU,CApBRD,EAMM,MANNE,EAMM,CALJC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAH,EAA4F,QAAA,CAArF,MAAM,4DAA4D,EAAC,aAAU,EAAA,KACpFA,EAGS,SAAA,CAHQ,sBAAAG,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAhC,EAAQ,cAAagC,GAAE,MAAM,6HAC5CD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAH,EAA+C,SAAA,CAAvC,MAAM,EAAE,EAAC,wBAAqB,EAAA,UACtCF,EAA6FO,EAAA,KAAAC,EAAzEnC,EAAA,MAALoC,QAAfT,EAA6F,SAAA,CAArD,IAAKS,EAAE,MAAQ,MAAOA,EAAE,KAAU,EAAAC,EAAAD,EAAE,KAAK,EAAA,EAAAE,CAAA,iBAFlE,CAAAC,EAAAtC,EAAQ,aAAa,MAMxC4B,EAOM,MAPNW,EAOM,CANJR,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAH,EAAwF,QAAA,CAAjF,MAAM,4DAA4D,EAAC,SAAM,EAAA,KAChFA,EAIS,SAAA,CAJQ,sBAAAG,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAhC,EAAQ,OAAMgC,GAAE,MAAM,6IACrCJ,EAA4C,SAAA,CAApC,MAAM,WAAW,EAAC,YAAS,EAAA,EACnCA,EAAyC,SAAA,CAAjC,MAAM,SAAS,EAAC,WAAQ,EAAA,EAChCA,EAAmC,SAAA,CAA3B,MAAM,MAAM,EAAC,QAAK,EAAA,WAHX,CAAAU,EAAAtC,EAAQ,MAAM,MAOjC4B,EAES,SAAA,CAFA,QAAOf,EAAQ,MAAM,6FAC5Be,EAAoC,IAAA,CAAjC,MAAM,sBAAsB,EAAA,KAAA,EAAA,QAInCA,EA8CM,MA9CNY,EA8CM,CA7CJZ,EAuCQ,QAvCRa,EAuCQ,CAtCNb,EAMQ,QANRc,EAMQ,CALNd,EAIK,KAAA,KAAA,MAHHF,EAEKO,EAAA,KAAAC,EAFahC,EAAPyC,GAAXf,EAEK,KAAA,CAFuB,IAAKe,EAAI,IAAM,eAAgBA,EAAI,MAAK,UAAaA,EAAI,MAAK,EAAI,MAAM,sDAC/F,EAAAP,EAAAO,EAAI,KAAK,EAAA,CAAA,YAIlBf,EA8BQ,QA9BRgB,EA8BQ,QA7BNlB,EA4BKO,EAAA,KAAAC,EA5BapC,EAAA,MAAP+C,QAAXnB,EA4BK,KAAA,CA5BoB,OAAQmB,EAAI,MAAM,IAAIA,EAAI,EAAE,GAAI,MAAM,8CAC7DjB,EAEK,KAFLkB,EAEK,CADFlB,EAAkG,OAAA,CAA3F,SAAOT,EAAe0B,EAAI,MAAM,EAAS,0BAA0B,CAAA,CAAI,EAAAT,EAAAS,EAAI,MAAM,EAAA,CAAA,IAE3FjB,EAA4F,KAA5FmB,EAA4FX,EAAvCpB,EAAa6B,EAAI,aAAa,CAAA,EAAA,CAAA,EACnFjB,EAGK,KAHLoB,EAGK,KAFAH,EAAI,iBAAe,qBAAA,EAA4B,IAClD,CAAA,EAAAjB,EAA2E,MAA3EqB,EAA2Eb,EAAtBS,EAAI,SAAS,EAAA,CAAA,IAEpEjB,EAAgF,KAAhFsB,EAAgFd,EAAhCxB,EAAciC,EAAI,KAAK,CAAA,EAAA,CAAA,EACvEjB,EAEK,KAFLuB,EAEK,CADHvB,EAAuG,OAAA,CAAhG,SAAOX,EAAe4B,EAAI,MAAM,EAAS,+BAA+B,CAAA,CAAI,EAAAT,EAAAS,EAAI,MAAM,EAAA,CAAA,IAG/FjB,EAaK,KAbLwB,GAaK,CAZHxB,EAWM,MAXNyB,GAWM,CATIR,EAAI,SAAM,YADlBnB,EAMS,SAAA,OAJN,QAAKM,IAAEvB,EAASoC,CAAG,EACpB,MAAM,6GACP,UAED,EAAAS,EAAA,wBACA1B,EAES,SAAA,CAFD,MAAM,kGAAgG,CAC5GA,EAAqC,IAAA,CAAlC,MAAM,uBAAuB,CAAA,2BAQhChC,EAAA,OAAWE,EAAA,MAAK,SAAM,GAAlC2B,IAAAC,EAGM,MAHN6B,GAGM,CAAA,GAAAxB,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAA,CAFJH,EAA8D,IAAA,CAA3D,MAAM,gDAAgD,EAAA,KAAA,EAAA,EACzDA,EAA2F,IAAA,CAAxF,MAAM,mDAAmD,EAAC,6BAA0B,EAAA,kBAKnFzB,EAAA,WADRqD,EAOEC,EAAA,OALC,KAAMtD,EAAA,MACN,QAASC,EAAA,MACT,eAAgBsD,EAAAA,yBAChB,uBAAOvD,EAAA,MAAmB,IAC1B,UAASwD,EAAAA"}