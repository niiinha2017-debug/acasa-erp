import{f as _,y as V,g as x,i as B,m as d,s as c,r as C,c as u,o as l,b as t,k as j,E as D,d as k,w as P,v as z,u as n,A as p,l as S,t as r,e as M,p as F,P as L,a6 as E,q}from"./index-CH22lQIC.js";const G={class:"w-full max-w-[1200px] mx-auto px-2 sm:px-3 lg:px-4 space-y-4 animate-page-in"},H={class:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 pt-2"},J={class:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 w-full sm:w-auto"},K={class:"relative w-full sm:w-72"},Q={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},W={class:"p-4 rounded-xl bg-white border border-slate-200 shadow-sm"},X={class:"text-xl font-black text-slate-800"},Y={class:"p-4 rounded-xl bg-white border border-slate-200 shadow-sm"},Z={class:"text-xl font-black text-blue-600"},ee={class:"rounded-xl border border-slate-200 bg-white overflow-hidden shadow-sm"},te={class:"flex items-center gap-3 py-1"},se={class:"w-8 h-8 rounded-lg border border-slate-100 bg-slate-50 overflow-hidden flex items-center justify-center"},oe=["src"],ae={key:1,class:"font-black text-slate-400 text-[10px] uppercase"},re={class:"flex flex-col min-w-0"},le={class:"text-sm font-bold text-slate-800 uppercase tracking-tight leading-tight truncate"},ne={class:"text-[10px] font-bold text-slate-400 tracking-wider uppercase"},ie={class:"text-xs font-black text-slate-800 tabular-nums"},de={class:"flex justify-end gap-1 px-2"},ce=["onClick"],ue=["onClick"],fe={__name:"index",setup(pe){const i=_([]),m=_(!1),f=V(),g=_(""),U=[{key:"nome_produto",label:"PRODUTO / REF",width:"34%"},{key:"fornecedor_nome",label:"FORNECEDOR",width:"24%"},{key:"unidade",label:"UN",width:"8%",align:"center"},{key:"valor_unitario",label:"VLR UNIT",width:"14%",align:"right"},{key:"status",label:"STATUS",width:"10%",align:"center"},{key:"acoes",label:"",width:"10%",align:"right"}],b=x(()=>{const s=String(g.value||"").trim().toUpperCase();return s?(i.value||[]).filter(e=>{var w,y;const a=String(e.nome_produto||"").toUpperCase(),v=String(((w=e.fornecedor)==null?void 0:w.razao_social)||((y=e.fornecedor)==null?void 0:y.nome_fantasia)||"").toUpperCase(),o=String(e.cor||"").toUpperCase(),h=String(e.medida||"").toUpperCase(),I=String(e.marca||"").toUpperCase(),O=String(e.id||"").toUpperCase();return`${a} ${v} ${o} ${h} ${I} ${O}`.includes(s)}):i.value||[]}),N=x(()=>b.value.map(s=>{var e,a;return{...s,fornecedor_nome:((e=s.fornecedor)==null?void 0:e.razao_social)||((a=s.fornecedor)==null?void 0:a.nome_fantasia)||"-",valor_unitario:Number(s.valor_unitario||0)}})),T=x(()=>b.value.length),A=x(()=>b.value.filter(s=>s.status==="ATIVO").length);async function $(){m.value=!0;try{const s=await E.get("/produtos");i.value=s.data||[]}catch(s){console.error("Erro ao buscar produtos:",(s==null?void 0:s.response)||s),c.error("Erro ao carregar produtos.")}finally{m.value=!1}}async function R(s){if(!d("produtos.excluir"))return c.error("Acesso negado.");if(await q.show("Excluir Produto",`Deseja excluir o produto "${s==null?void 0:s.nome_produto}"? Esta ação não pode ser desfeita.`))try{await E.delete(`/produtos/${s.id}`),i.value=i.value.filter(a=>a.id!==s.id),c.success("Produto excluído!")}catch{c.error("Erro ao excluir.")}}return B(async()=>{if(!d("produtos.ver")){c.error("Acesso negado."),f.push("/");return}await $()}),(s,e)=>{const a=C("Button"),v=C("Table");return l(),u("div",G,[t("div",H,[e[4]||(e[4]=j('<div class="flex items-center gap-3"><div class="w-10 h-10 rounded-xl bg-slate-900 text-white flex items-center justify-center"><i class="pi pi-shopping-cart text-lg"></i></div><div><h1 class="text-lg font-black text-slate-800 uppercase tracking-tight">Insumos &amp; Materiais</h1><p class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Base de dados para industrialização</p></div></div>',1)),t("div",J,[t("div",K,[e[2]||(e[2]=t("i",{class:"pi pi-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-xs"},null,-1)),P(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>g.value=o),type:"text",placeholder:"BUSCAR MATERIAL OU FORNECEDOR...",class:"w-full pl-9 pr-3 h-10 bg-white border border-slate-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-brand-primary/10 focus:border-brand-primary outline-none transition-all uppercase"},null,512),[[z,g.value]])]),n(d)("produtos.criar")?(l(),D(a,{key:0,variant:"primary",size:"md",class:"!h-10 !rounded-xl !px-4 text-xs font-black uppercase tracking-wider w-full sm:w-auto",onClick:e[1]||(e[1]=o=>n(f).push("/produtos/novo"))},{default:p(()=>[...e[3]||(e[3]=[t("i",{class:"pi pi-plus mr-1.5 text-[10px]"},null,-1),S(" Novo Produto ",-1)])]),_:1})):k("",!0)])]),t("div",Q,[t("div",W,[e[5]||(e[5]=t("p",{class:"text-[9px] font-black uppercase tracking-[0.15em] text-slate-400 mb-1"},"Total de Itens",-1)),t("p",X,r(T.value),1)]),t("div",Y,[e[6]||(e[6]=t("p",{class:"text-[9px] font-black uppercase tracking-[0.15em] text-slate-400 mb-1"},"Produtos Ativos",-1)),t("p",Z,r(A.value),1)])]),t("div",ee,[M(v,{columns:U,rows:N.value,loading:m.value,boxed:!1,"empty-text":"Nenhum produto encontrado."},{"cell-nome_produto":p(({row:o})=>[t("div",te,[t("div",se,[String(o.imagem_url||"").trim()?(l(),u("img",{key:0,src:o.imagem_url,class:"w-full h-full object-cover",alt:"Imagem do produto"},null,8,oe)):(l(),u("span",ae,r(String(o.nome_produto||"").substring(0,2)),1))]),t("div",re,[t("span",le,r(o.nome_produto),1),t("span",ne," Ref: "+r(String(o.id||0).padStart(4,"0"))+" • "+r(o.marca||"S/ Marca"),1)])])]),"cell-valor_unitario":p(({row:o})=>[t("span",ie,r(n(L).currency(o.valor_unitario)),1)]),"cell-status":p(({row:o})=>[t("span",{class:F(["px-2 py-1 rounded text-[9px] font-black uppercase inline-flex items-center gap-1.5",o.status==="ATIVO"?"bg-emerald-50 text-emerald-600 border border-emerald-100":"bg-slate-50 text-slate-500 border border-slate-100"])},[e[7]||(e[7]=t("span",{class:"w-1.5 h-1.5 rounded-full bg-current"},null,-1)),S(" "+r(o.status||"INATIVO"),1)],2)]),"cell-acoes":p(({row:o})=>[t("div",de,[n(d)("produtos.editar")?(l(),u("button",{key:0,onClick:h=>n(f).push(`/produtos/${o.id}`),class:"w-7 h-7 rounded-lg bg-slate-100 text-slate-500 hover:bg-brand-primary hover:text-white transition-all flex items-center justify-center"},[...e[8]||(e[8]=[t("i",{class:"pi pi-pencil text-[10px]"},null,-1)])],8,ce)):k("",!0),n(d)("produtos.excluir")?(l(),u("button",{key:1,onClick:h=>R(o),class:"w-7 h-7 rounded-lg bg-red-50 text-red-500 hover:bg-red-500 hover:text-white transition-all flex items-center justify-center"},[...e[9]||(e[9]=[t("i",{class:"pi pi-trash text-[10px]"},null,-1)])],8,ue)):k("",!0)])]),_:1},8,["rows","loading"])])])}}};export{fe as default};
//# sourceMappingURL=index-BUZgX8kw.js.map
