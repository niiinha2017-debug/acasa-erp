import{f as c,h as N,i as R,S as M,c as l,b as e,E as P,d as x,w as k,a4 as E,F as m,n as g,a5 as f,s as d,r as B,o as s,t as r,B as T,p as w,l as V,q as I}from"./index-CH22lQIC.js";const G={class:"p-6 bg-slate-50 min-h-screen"},L={class:"bg-white p-4 rounded-xl shadow-sm border border-slate-200 mb-6 flex gap-4 items-end"},$={class:"flex-1 max-w-sm"},j=["value"],U={class:"w-48"},z={class:"bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden"},q={class:"w-full text-left border-collapse"},H={class:"bg-slate-800 text-white"},Y={class:"divide-y divide-slate-100"},J={class:"p-4 italic font-black text-[9px]"},K={class:"p-4 font-black text-sm text-slate-700"},Q={class:"p-4 font-black text-sm uppercase italic text-slate-800"},W={class:"text-[9px] text-slate-400 not-italic"},X={class:"p-4 text-right font-black italic"},Z={class:"p-4 uppercase font-black text-[10px]"},ee={class:"p-4 text-right"},te={class:"flex justify-end gap-2"},ae=["onClick"],oe={key:0,class:"p-20 text-center"},ne={__name:"index",setup(se){const i=c(!1),p=c([]),v=c([]),n=N({fornecedor_id:"",status:"EM_ABERTO"}),O=[{key:"origem",label:"ORIGEM",width:"100px"},{key:"vencimento",label:"VENCIMENTO",width:"120px"},{key:"fornecedor",label:"FORNECEDOR/DESCRIÇÃO"},{key:"valor",label:"VALOR TOTAL",width:"140px",align:"right"},{key:"status",label:"STATUS",width:"100px"},{key:"acoes",label:"",width:"80px",align:"right"}],u=c(!1),h=c(null);async function C(){if(!n.fornecedor_id)return d.warn("Selecione um fornecedor para iniciar o fechamento");try{i.value=!0;const o=await f.previewFechamentoFornecedor({fornecedor_id:n.fornecedor_id,mes:new Date().getMonth()+1,ano:new Date().getFullYear()});h.value=o,u.value=!0}catch{d.error("Não foi possível gerar o preview de fechamento")}finally{i.value=!1}}async function S(o){if(await I(`Deseja confirmar o pagamento de ${y(o.valor)}?`))try{await f.pagarContaPagar(o.id,{unidade:"FÁBRICA",categoria:"PAGAMENTO_FORNECEDOR"}),d.success("Pagamento registrado com sucesso!"),b()}catch{d.error("Erro ao registrar pagamento")}}async function b(){try{i.value=!0;const o=await f.listarContasPagarConsolidado(n);p.value=o||[]}catch{d.error("Erro ao carregar contas a pagar")}finally{i.value=!1}}const y=o=>o.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),F=o=>o?new Date(o).toLocaleDateString("pt-BR"):"-",A=o=>({EM_ABERTO:"bg-blue-100 text-blue-700 border-blue-200",VENCIDO:"bg-rose-100 text-rose-700 border-rose-200 animate-pulse",PAGO:"bg-emerald-100 text-emerald-700 border-emerald-200"})[o]||"bg-slate-100 text-slate-700",D=o=>({DESPESA:"text-purple-600 bg-purple-50 border-purple-100",COMPRA:"text-orange-600 bg-orange-50 border-orange-100",FECHAMENTO:"text-blue-600 bg-blue-50 border-blue-100"})[o]||"text-slate-600 bg-slate-50";return R(async()=>{const o=await M.listarAtivos();v.value=o.map(t=>({label:t.nome_fantasia,value:t.id})),b()}),(o,t)=>{const _=B("ModalFechamento");return s(),l("div",G,[e("header",{class:"flex justify-between items-end mb-8"},[t[3]||(t[3]=e("div",null,[e("h1",{class:"text-2xl font-black text-slate-800 uppercase italic tracking-tighter"},"Contas a Pagar"),e("p",{class:"text-xs text-slate-500 font-bold uppercase"},"Gestão Consolidada de Saídas")],-1)),e("div",{class:"flex gap-3"},[e("button",{onClick:C,class:"bg-slate-900 text-white px-4 py-2 rounded-lg font-black text-[10px] uppercase italic hover:bg-slate-800 transition-all shadow-lg"}," Novo Fechamento Mensal ")])]),e("section",L,[e("div",$,[t[5]||(t[5]=e("label",{class:"text-[10px] font-black text-slate-400 uppercase mb-1 block"},"Fornecedor",-1)),k(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>n.fornecedor_id=a),class:"w-full bg-slate-50 border border-slate-200 rounded-lg p-2 text-xs font-bold uppercase outline-none focus:border-blue-500"},[t[4]||(t[4]=e("option",{value:""},"TODOS OS FORNECEDORES",-1)),(s(!0),l(m,null,g(v.value,a=>(s(),l("option",{key:a.value,value:a.value},r(a.label),9,j))),128))],512),[[E,n.fornecedor_id]])]),e("div",U,[t[7]||(t[7]=e("label",{class:"text-[10px] font-black text-slate-400 uppercase mb-1 block"},"Status",-1)),k(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>n.status=a),class:"w-full bg-slate-50 border border-slate-200 rounded-lg p-2 text-xs font-bold uppercase outline-none focus:border-blue-500"},[...t[6]||(t[6]=[e("option",{value:"EM_ABERTO"},"EM ABERTO",-1),e("option",{value:"VENCIDO"},"VENCIDOS",-1),e("option",{value:"PAGO"},"PAGOS",-1)])],512),[[E,n.status]])]),e("button",{onClick:b,class:"bg-blue-600 text-white p-2.5 rounded-lg hover:bg-blue-700 transition-all"},[...t[8]||(t[8]=[e("i",{class:"pi pi-search text-sm"},null,-1)])])]),e("div",z,[e("table",q,[e("thead",H,[e("tr",null,[(s(),l(m,null,g(O,a=>e("th",{key:a.key,style:T({width:a.width,textAlign:a.align}),class:"p-4 text-[10px] font-black uppercase tracking-widest"},r(a.label),5)),64))])]),e("tbody",Y,[(s(!0),l(m,null,g(p.value,a=>(s(),l("tr",{key:`${a.origem}-${a.id}`,class:"hover:bg-slate-50 transition-colors group"},[e("td",J,[e("span",{class:w([D(a.origem),"px-2 py-1 rounded border"])},r(a.origem),3)]),e("td",K,r(F(a.vencimento_em)),1),e("td",Q,[V(r(a.fornecedor_nome||"DESPESA OPERACIONAL")+" ",1),e("div",W,r(a.descricao),1)]),e("td",X,r(y(a.valor)),1),e("td",Z,[e("span",{class:w([A(a.status),"px-2 py-1 rounded-full border"])},r(a.status),3)]),e("td",ee,[e("div",te,[a.status!=="PAGO"?(s(),l("button",{key:0,onClick:le=>S(a),class:"h-7 px-3 rounded bg-emerald-500 text-white text-[9px] font-black uppercase hover:bg-emerald-600 shadow-sm"}," Pagar ",8,ae)):x("",!0),t[9]||(t[9]=e("button",{class:"w-7 h-7 rounded bg-slate-100 text-slate-400 hover:bg-slate-900 hover:text-white transition-all"},[e("i",{class:"pi pi-eye text-[10px]"})],-1))])])]))),128))])]),!i.value&&p.value.length===0?(s(),l("div",oe,[...t[10]||(t[10]=[e("i",{class:"pi pi-inbox text-4xl text-slate-200 mb-4 block"},null,-1),e("p",{class:"text-slate-400 font-bold uppercase italic text-xs"},"Nenhum registro encontrado",-1)])])):x("",!0)]),u.value?(s(),P(_,{key:0,open:u.value,preview:h.value,fornecedorNome:o.nomeFornecedorFechamento,onClose:t[2]||(t[2]=a=>u.value=!1),onConfirm:o.executarFechamentoFinal},null,8,["open","preview","fornecedorNome","onConfirm"])):x("",!0)])}}};export{ne as default};
//# sourceMappingURL=index-NAuFXO_C.js.map
