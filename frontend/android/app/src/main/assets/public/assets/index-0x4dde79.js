import{y as $,f as g,g as v,i as z,r as T,c as _,o as x,b as s,k as U,E as q,d as h,w as H,v as J,u as l,m as d,A as i,l as K,t as o,P as u,e as Q,p as y,a1 as j,s as p,q as W}from"./index-CH22lQIC.js";const X={class:"w-full max-w-[1200px] mx-auto space-y-4 animate-page-in"},Y={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 p-2"},Z={class:"flex flex-col sm:flex-row items-center gap-2 w-full sm:w-auto"},ee={class:"relative w-full sm:w-56"},te={class:"grid grid-cols-2 lg:grid-cols-4 gap-3"},se={class:"p-4 rounded-xl bg-white border border-slate-200 shadow-sm"},ae={class:"text-xl font-black text-slate-800"},re={class:"p-4 rounded-xl bg-white border border-emerald-200 shadow-sm"},oe={class:"text-xl font-black text-emerald-700"},le={class:"p-4 rounded-xl bg-white border border-rose-200 shadow-sm"},ne={class:"text-xl font-black text-rose-700"},ie={class:"p-4 rounded-xl bg-white border border-amber-200 shadow-sm"},ce={class:"text-xl font-black text-amber-700"},de={class:"rounded-xl border border-slate-200 bg-white overflow-hidden shadow-sm"},ue={class:"flex items-center justify-center"},pe={class:"py-1"},xe={class:"text-sm font-bold text-slate-800 block"},me={class:"flex items-center gap-2 mt-0.5"},fe={class:"text-[10px] font-medium text-slate-500"},be={key:0,class:"text-[8px] font-black text-rose-600 px-1.5 py-0.5 bg-rose-50 rounded border border-rose-100"},ge={class:"text-right"},ve={class:"text-[10px] font-medium text-slate-400 mt-0.5"},_e={class:"text-center"},he={class:"text-sm font-medium text-slate-700"},ye={class:"flex justify-center"},ke={class:"flex justify-center gap-1"},we=["onClick"],Ae=["onClick"],Ce={__name:"index",setup(Ee){const S=$(),k=g([]),w=g(!1),A=g(""),C=g(!1),O=[{key:"tipo",label:"",width:"5%",align:"center"},{key:"detalhes",label:"Detalhes",width:"40%"},{key:"valor",label:"Valor",align:"right",width:"20%"},{key:"vencimento",label:"Vencimento",align:"center",width:"15%"},{key:"status",label:"Status",align:"center",width:"15%"},{key:"acoes",label:"",align:"center",width:"5%"}];function V(t){const e=String(t||"").toUpperCase().trim();return e==="SAÍDA"||e==="SAIDA"?"SAIDA":"ENTRADA"}function n(t){return V(t==null?void 0:t.tipo_movimento)==="SAIDA"}function M(t){if(!(t!=null&&t.data_vencimento)||t.status==="PAGO")return!1;const e=new Date(t.data_vencimento),r=new Date;return r.setHours(0,0,0,0),e<r}function m(t){if(t==null)return 0;if(typeof t=="number")return t;let e=String(t).replace("R$","").trim();return e.includes(",")&&e.includes(".")?e=e.replace(/\./g,"").replace(",","."):e=e.replace(",","."),parseFloat(e)||0}function R(t){const e=String(t||"EM_ABERTO").toUpperCase(),r={PAGO:"bg-emerald-50 text-emerald-600 border border-emerald-100",EM_ABERTO:"bg-amber-50 text-amber-600 border border-amber-100",VENCIDO:"bg-rose-50 text-rose-600 border border-rose-100",CANCELADO:"bg-slate-100 text-slate-500 border border-slate-200"};return r[e]||r.EM_ABERTO}const f=v(()=>{const t=A.value.toLowerCase().trim();return t?k.value.filter(e=>[e.categoria,e.classificacao,e.status,e.valor_total].some(r=>String(r||"").toLowerCase().includes(t))):k.value}),D=v(()=>f.value.filter(n).reduce((t,e)=>t+m(e.valor_total),0)),N=v(()=>f.value.filter(t=>!n(t)).reduce((t,e)=>t+m(e.valor_total),0)),P=v(()=>f.value.filter(t=>n(t)&&t.status!=="PAGO").reduce((t,e)=>t+m(e.valor_total),0));async function B(){w.value=!0;try{const t=await j.listar();k.value=((t==null?void 0:t.data)||[]).sort((e,r)=>new Date(r.data_vencimento)-new Date(e.data_vencimento))}catch{p.error("Erro ao carregar dados")}finally{w.value=!1}}const I=()=>{if(!d("despesas.criar"))return p.error("Acesso negado.");S.push("/despesas/novo")},L=t=>{if(!d("despesas.editar"))return p.error("Acesso negado.");S.push(`/despesas/${t}`)};async function F(t){var b,a;if(!d("despesas.excluir"))return p.error("Acesso negado.");if(!await W.show("Excluir Lançamento?","Esta ação não pode ser desfeita."))return;const r=Number(t);try{C.value=!0,await j.remover(r),await B(),p.success("Lançamento removido com sucesso")}catch(c){console.error("Erro ao excluir:",c);const E=(a=(b=c==null?void 0:c.response)==null?void 0:b.data)==null?void 0:a.message,G=Array.isArray(E)?E.join(" | "):E||"Não foi possível excluir";p.error(G)}finally{C.value=!1}}return z(B),(t,e)=>{const r=T("Button"),b=T("Table");return x(),_("div",X,[s("div",Y,[e[3]||(e[3]=U('<div class="flex items-center gap-3"><div class="w-10 h-10 rounded-xl bg-slate-900 text-white flex items-center justify-center"><i class="pi pi-chart-line text-lg"></i></div><div><h1 class="text-lg font-black text-slate-800 uppercase tracking-tight">Fluxo Financeiro</h1><p class="text-[10px] font-bold text-slate-400 uppercase tracking-wider">Gestão de caixa</p></div></div>',1)),s("div",Z,[s("div",ee,[e[1]||(e[1]=s("i",{class:"pi pi-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-xs"},null,-1)),H(s("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>A.value=a),type:"text",placeholder:"Buscar por categoria ou status...",class:"w-full pl-9 pr-3 h-10 bg-white border border-slate-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-brand-primary/10 focus:border-brand-primary outline-none transition-all"},null,512),[[J,A.value]])]),l(d)("despesas.criar")?(x(),q(r,{key:0,variant:"primary",size:"md",class:"!h-10 !rounded-xl !px-4 text-xs font-black uppercase tracking-wider",onClick:I},{default:i(()=>[...e[2]||(e[2]=[s("i",{class:"pi pi-plus mr-1.5 text-[10px]"},null,-1),K(" Novo ",-1)])]),_:1})):h("",!0)])]),s("div",te,[s("div",se,[e[4]||(e[4]=s("p",{class:"text-[9px] font-black uppercase tracking-[0.15em] text-slate-400"},"Saldo",-1)),s("p",ae,o(l(u).currency(N.value-D.value)),1)]),s("div",re,[e[5]||(e[5]=s("p",{class:"text-[9px] font-black uppercase tracking-[0.15em] text-emerald-600"},"Entradas",-1)),s("p",oe,o(l(u).currency(N.value)),1)]),s("div",le,[e[6]||(e[6]=s("p",{class:"text-[9px] font-black uppercase tracking-[0.15em] text-rose-600"},"Saídas",-1)),s("p",ne,o(l(u).currency(D.value)),1)]),s("div",ie,[e[7]||(e[7]=s("p",{class:"text-[9px] font-black uppercase tracking-[0.15em] text-amber-600"},"Em Aberto",-1)),s("p",ce,o(l(u).currency(P.value)),1)])]),s("div",de,[Q(b,{columns:O,rows:f.value,loading:w.value,"empty-text":"Nenhum lançamento encontrado.",boxed:!1},{"cell-tipo":i(({row:a})=>[s("div",ue,[s("div",{class:y(["w-7 h-7 rounded-lg flex items-center justify-center",n(a)?"bg-rose-50 text-rose-500":"bg-emerald-50 text-emerald-500"])},[s("i",{class:y(["pi text-xs",n(a)?"pi-arrow-down-right":"pi-arrow-up-right"])},null,2)],2)])]),"cell-detalhes":i(({row:a})=>[s("div",pe,[s("span",xe,o(a.categoria||"—"),1),s("div",me,[s("span",fe,o(a.classificacao||"—"),1),M(a)?(x(),_("span",be," ATRASADO ")):h("",!0)])])]),"cell-valor":i(({row:a})=>[s("div",ge,[s("span",{class:y(["text-sm font-bold",n(a)?"text-rose-600":"text-emerald-600"])},o(n(a)?"-":"+")+" "+o(l(u).currency(m(a.valor_total))),3),s("p",ve,o(a.forma_pagamento),1)])]),"cell-vencimento":i(({row:a})=>[s("div",_e,[s("span",he,o(l(u).date(a.data_vencimento)),1)])]),"cell-status":i(({row:a})=>[s("div",ye,[s("span",{class:y(["px-2 py-1 rounded text-[9px] font-black uppercase",R(a.status)])},o(a.status||"EM_ABERTO"),3)])]),"cell-acoes":i(({row:a})=>[s("div",ke,[l(d)("despesas.editar")?(x(),_("button",{key:0,onClick:c=>L(a.id),class:"w-7 h-7 rounded-lg bg-slate-100 text-slate-500 hover:bg-brand-primary hover:text-white transition-all flex items-center justify-center"},[...e[8]||(e[8]=[s("i",{class:"pi pi-pencil text-xs"},null,-1)])],8,we)):h("",!0),l(d)("despesas.excluir")?(x(),_("button",{key:1,onClick:c=>F(a.id),class:"w-7 h-7 rounded-lg bg-red-50 text-red-500 hover:bg-red-500 hover:text-white transition-all flex items-center justify-center"},[...e[9]||(e[9]=[s("i",{class:"pi pi-trash text-xs"},null,-1)])],8,Ae)):h("",!0)])]),_:1},8,["rows","loading"])])])}}};export{Ce as default};
//# sourceMappingURL=index-0x4dde79.js.map
