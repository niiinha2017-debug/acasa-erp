import{_ as Y,f as y,g as f,h as q,i as G,E as A,A as i,a5 as L,r as b,o as c,e as s,b as o,c as m,F as p,t as r,u as _,P as g,l as u,T as J,d as K,H as Q,w as W,v as Z}from"./index-CH22lQIC.js";const ee={class:"p-6 relative space-y-6"},te={class:"grid grid-cols-12 gap-4"},oe={class:"grid grid-cols-12 gap-4"},ae={class:"col-span-12 md:col-span-4 px-4 py-3 rounded-2xl bg-gray-50 border border-gray-100"},le={class:"text-lg font-black text-gray-900"},ne={class:"text-xs font-bold text-gray-500"},se={class:"col-span-12 md:col-span-4 px-4 py-3 rounded-2xl bg-green-50 border border-green-100"},re={class:"text-lg font-black text-green-700"},ie={class:"text-xs font-bold text-green-600"},ce={class:"col-span-12 md:col-span-4 px-4 py-3 rounded-2xl bg-amber-50 border border-amber-100"},de={class:"text-lg font-black text-amber-700"},ue={class:"text-xs font-bold text-amber-600"},me={class:"font-black text-gray-900"},be={class:"text-xs font-bold text-gray-400"},pe={class:"font-black text-gray-900"},_e={class:"text-xs font-bold text-gray-400"},ge={class:"text-xs font-black text-gray-900"},ve={class:"font-black text-gray-900 text-right"},fe={class:"text-xs font-bold text-gray-400 text-right"},xe={class:"flex justify-end gap-2"},ye={class:"relative w-full max-w-2xl rounded-3xl bg-white shadow-2xl overflow-hidden"},he={class:"px-6 py-5 border-b border-gray-100 bg-gray-50/40"},ke={class:"text-lg font-black text-gray-900"},Se={class:"p-6 space-y-6"},Ce={class:"grid grid-cols-12 gap-4"},Ve={class:"col-span-12 md:col-span-6"},Oe={class:"col-span-12 md:col-span-6"},Ee={class:"col-span-12 md:col-span-6"},Ne={class:"col-span-12 md:col-span-6"},Ie={class:"grid grid-cols-12 gap-4"},Te={class:"col-span-12 md:col-span-6"},Re={class:"col-span-12 md:col-span-6"},De={class:"col-span-12"},Be={class:"px-6 py-4 border-t border-gray-100 bg-gray-50/40 flex items-center justify-end gap-3"},Ae={__name:"index",setup(Le){const S=y(!0),R=y([]),C=y(""),h=y(null),V=y(null),w=[{label:"EM_ABERTO",value:"EM_ABERTO"},{label:"VENCIDO",value:"VENCIDO"},{label:"RECEBIDO",value:"RECEBIDO"},{label:"CANCELADO",value:"CANCELADO"}],$=[{key:"partes",label:"Parte / Descrição"},{key:"origem",label:"Origem",width:"180px"},{key:"vencimento",label:"Vencimento",width:"160px"},{key:"valor",label:"Valor",width:"200px",align:"right"},{key:"status",label:"Status",width:"160px"},{key:"acoes",label:"Ações",width:"160px",align:"right"}],O=f(()=>{const a=String(C.value||"").trim().toLowerCase(),e=h.value?String(h.value).trim():null;return(R.value||[]).filter(n=>e&&String(n.status||"").trim()!==e?!1:a?[n.descricao,n.observacao,n.origem_tipo,n.origem_id,n.status,n.forma_recebimento_chave,n.cliente_id,n.fornecedor_id].filter(Boolean).join(" ").toLowerCase().includes(a):!0)}),E=f(()=>{const a=O.value||[],e={total:a.length,recebido:0,aberto:0};for(const n of a)String(n.status||"").toUpperCase()==="RECEBIDO"?e.recebido+=1:e.aberto+=1;return e}),N=f(()=>{const a=O.value||[],e={total:0,recebido:0,aberto:0};for(const n of a){const v=String(n.status||"").toUpperCase(),d=Number(n.valor_original||0);e.total+=d,v==="RECEBIDO"?e.recebido+=d:e.aberto+=d}return e});async function D(){S.value=!0;try{const{data:a}=await L.listarReceber({});R.value=Array.isArray(a)?a:[]}finally{S.value=!1}}const t=q({open:!1,saving:!1,id:null,cliente_id:null,fornecedor_id:null,origem_tipo:null,origem_id:null,descricao:"",observacao:"",valor_original:0,valor_compensado:0,vencimento_em:null,forma_recebimento_chave:"",recebido_em_input:""});function M(a){if(!a)return"";const e=new Date(a);if(Number.isNaN(e.getTime()))return"";const n=e.getFullYear(),v=String(e.getMonth()+1).padStart(2,"0"),d=String(e.getDate()).padStart(2,"0"),T=String(e.getHours()).padStart(2,"0"),x=String(e.getMinutes()).padStart(2,"0");return`${n}-${v}-${d}T${T}:${x}`}function P(a){if(!a)return null;const e=new Date(a);return Number.isNaN(e.getTime())?null:e.toISOString()}const B=f(()=>!(t.saving||!t.id||!String(t.recebido_em_input||"").trim()));function F(a){t.open=!0,t.saving=!1,t.id=a.id,t.cliente_id=a.cliente_id??null,t.fornecedor_id=a.fornecedor_id??null,t.origem_tipo=a.origem_tipo??null,t.origem_id=a.origem_id??null,t.descricao=a.descricao??"",t.observacao=a.observacao??"",t.valor_original=Number(a.valor_original||0),t.valor_compensado=Number(a.valor_compensado||0),t.vencimento_em=a.vencimento_em??null,t.forma_recebimento_chave=a.forma_recebimento_chave??"",t.recebido_em_input=M(new Date().toISOString())}function I(){t.open=!1}const U=f(()=>t.cliente_id?`Cliente #${t.cliente_id}`:t.fornecedor_id?`Fornecedor #${t.fornecedor_id}`:"—"),j=f(()=>{const a=t.origem_tipo?String(t.origem_tipo):"",e=t.origem_id?`#${t.origem_id}`:"—";return a?`${a} ${e}`:"—"});Object.defineProperty(t,"parteLabel",{get:()=>U.value}),Object.defineProperty(t,"origemLabel",{get:()=>j.value});async function H(){if(B.value){V.value=t.id,t.saving=!0;try{const a={status:"RECEBIDO",recebido_em:P(t.recebido_em_input),forma_recebimento_chave:t.forma_recebimento_chave?String(t.forma_recebimento_chave).trim():null,observacao:t.observacao?String(t.observacao).trim():null};await L.receber(t.id,a),I(),await D()}finally{t.saving=!1,V.value=null}}}return G(D),(a,e)=>{const n=b("PageHeader"),v=b("Loading"),d=b("SearchInput"),T=b("StatusBadge"),x=b("Button"),z=b("Table"),k=b("Input"),X=b("Card");return c(),A(X,{shadow:!0},{default:i(()=>[s(n,{title:"Contas a Receber",subtitle:"Receitas previstas e recebidas (cliente ou fornecedor).",icon:"pi pi-arrow-up-right",backTo:null}),o("div",ee,[S.value?(c(),A(v,{key:0})):(c(),m(p,{key:1},[o("div",te,[s(d,{class:"col-span-12 md:col-span-7",modelValue:C.value,"onUpdate:modelValue":e[0]||(e[0]=l=>C.value=l),mode:"search",label:"Buscar",placeholder:"Buscar por descrição, origem, status..."},null,8,["modelValue"]),s(d,{class:"col-span-12 md:col-span-5",modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=l=>h.value=l),mode:"select",label:"Status",placeholder:"Selecione...",options:w},null,8,["modelValue"])]),o("div",oe,[o("div",ae,[e[5]||(e[5]=o("div",{class:"text-[9px] font-black uppercase tracking-[0.22em] text-gray-400"},"Total",-1)),o("div",le,r(_(g).currency(N.value.total)),1),o("div",ne,r(E.value.total)+" registros",1)]),o("div",se,[e[6]||(e[6]=o("div",{class:"text-[9px] font-black uppercase tracking-[0.22em] text-green-500"},"Recebidos",-1)),o("div",re,r(_(g).currency(N.value.recebido)),1),o("div",ie,r(E.value.recebido)+" registros",1)]),o("div",ce,[e[7]||(e[7]=o("div",{class:"text-[9px] font-black uppercase tracking-[0.22em] text-amber-500"},"Em aberto",-1)),o("div",de,r(_(g).currency(N.value.aberto)),1),o("div",ue,r(E.value.aberto)+" registros",1)])]),s(z,{columns:$,rows:O.value,loading:!1,emptyText:"Nenhuma conta a receber encontrada.",boxed:!0},{"cell-partes":i(({row:l})=>[o("div",me,[l.cliente_id?(c(),m(p,{key:0},[u("Cliente #"+r(l.cliente_id),1)],64)):l.fornecedor_id?(c(),m(p,{key:1},[u("Fornecedor #"+r(l.fornecedor_id),1)],64)):(c(),m(p,{key:2},[u("—")],64))]),o("div",be,[l.descricao?(c(),m(p,{key:0},[u(r(l.descricao),1)],64)):(c(),m(p,{key:1},[u("Sem descrição")],64))])]),"cell-origem":i(({row:l})=>[o("div",pe,r(l.origem_tipo||"—"),1),o("div",_e,[l.origem_id?(c(),m(p,{key:0},[u("#"+r(l.origem_id),1)],64)):(c(),m(p,{key:1},[u("—")],64))])]),"cell-vencimento":i(({row:l})=>[o("div",ge,r(_(g).date(l.vencimento_em)),1)]),"cell-valor":i(({row:l})=>[o("div",ve,r(_(g).currency(Number(l.valor_original||0))),1),o("div",fe," Comp.: "+r(_(g).currency(Number(l.valor_compensado||0))),1)]),"cell-status":i(({row:l})=>[s(T,{value:l.status},null,8,["value"])]),"cell-acoes":i(({row:l})=>[o("div",xe,[s(x,{variant:"secondary",size:"sm",type:"button",disabled:V.value===l.id,onClick:we=>F(l)},{default:i(()=>[...e[8]||(e[8]=[u(" Receber ",-1)])]),_:1},8,["disabled","onClick"])])]),_:1},8,["rows"])],64)),s(J,{name:"fade-slide"},{default:i(()=>[t.open?(c(),m("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4",onMousedown:Q(I,["self"])},[e[14]||(e[14]=o("div",{class:"absolute inset-0 bg-black/20 backdrop-blur-sm"},null,-1)),o("div",ye,[o("div",he,[e[9]||(e[9]=o("div",{class:"text-xs font-black uppercase tracking-[0.22em] text-gray-400"},"Receber",-1)),o("div",ke," Conta a Receber #"+r(t.id),1)]),o("div",Se,[o("div",Ce,[o("div",Ve,[s(k,{modelValue:t.parteLabel,label:"Parte",readonly:""},null,8,["modelValue"])]),o("div",Oe,[s(k,{modelValue:t.origemLabel,label:"Origem",readonly:""},null,8,["modelValue"])]),o("div",Ee,[s(k,{modelValue:_(g).currency(Number(t.valor_original||0)),label:"Valor",readonly:""},null,8,["modelValue"])]),o("div",Ne,[s(k,{modelValue:_(g).date(t.vencimento_em),label:"Vencimento",readonly:""},null,8,["modelValue"])])]),e[11]||(e[11]=o("div",{class:"h-px bg-slate-100"},null,-1)),o("div",Ie,[o("div",Te,[s(d,{modelValue:t.forma_recebimento_chave,"onUpdate:modelValue":e[2]||(e[2]=l=>t.forma_recebimento_chave=l),mode:"search",label:"Forma de recebimento (chave)",placeholder:"Ex: PIX, DINHEIRO, CARTAO..."},null,8,["modelValue"])]),o("div",Re,[e[10]||(e[10]=o("label",{class:"text-[10px] font-black uppercase tracking-[0.18em] text-gray-400 mb-2 block"}," Data de recebimento ",-1)),W(o("input",{type:"datetime-local",class:"w-full h-12 px-4 rounded-2xl bg-gray-100 border-none font-bolding text-gray-700 font-bold","onUpdate:modelValue":e[3]||(e[3]=l=>t.recebido_em_input=l)},null,512),[[Z,t.recebido_em_input]])]),o("div",De,[s(d,{modelValue:t.observacao,"onUpdate:modelValue":e[4]||(e[4]=l=>t.observacao=l),mode:"search",label:"Observação",placeholder:"Opcional..."},null,8,["modelValue"])])])]),o("div",Be,[s(x,{variant:"secondary",type:"button",disabled:t.saving,onClick:I},{default:i(()=>[...e[12]||(e[12]=[u(" Cancelar ",-1)])]),_:1},8,["disabled"]),s(x,{variant:"primary",type:"button",loading:t.saving,disabled:!B.value,onClick:H},{default:i(()=>[...e[13]||(e[13]=[u(" Confirmar ",-1)])]),_:1},8,["loading","disabled"])])])],32)):K("",!0)]),_:1})])]),_:1})}}},Me=Y(Ae,[["__scopeId","data-v-c4a01597"]]);export{Me as default};
//# sourceMappingURL=index-EKMAKGlP.js.map
